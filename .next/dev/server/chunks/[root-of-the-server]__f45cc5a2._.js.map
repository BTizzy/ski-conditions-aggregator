{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///Users/ryanbartell/ski-conditions-aggregator/app/api/radar/frames/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server';\n\nexport const dynamic = 'force-dynamic';\nexport const revalidate = 300; // Cache for 5 minutes\n\n/**\n * Radar Frames API - Returns timestamps for precipitation radar animation\n * \n * Data Source: Synthetic radar data based on real historical weather station data\n * Coverage: Historical snowfall patterns with hourly temporal resolution\n * Updates: Every hour for 48-hour coverage\n */\nexport async function GET(request: Request) {\n  try {\n    console.log('[Radar Frames] Generating synthetic frames from real weather data...');\n    \n    // Generate synthetic frames only: every hour for last 48 hours\n    const now = Date.now();\n    const frames = [];\n    \n    // Synthetic data: every hour for last 48 hours (48 frames total)\n    const totalHours = 48;\n    const intervalMinutes = 60; // 1 frame per hour\n    const totalFrames = totalHours; // 48 frames for 48 hours\n    \n    for (let i = 0; i < totalFrames; i++) {\n      const timestamp = now - ((totalFrames - 1 - i) * intervalMinutes * 60 * 1000); // Start from oldest (47h ago) to newest (current)\n      frames.push({\n        time: Math.floor(timestamp / 1000), // Convert to seconds for frontend\n        url: `synthetic-${timestamp}` // Synthetic layer identifier\n      });\n    }\n    \n    console.log(`[Radar Frames] Generated ${frames.length} synthetic frames (1 per hour, ${totalHours}h coverage)`);\n\n    const result = {\n      radar: {\n        past: frames,\n        source: 'synthetic-real-data'\n      },\n      metadata: {\n        count: frames.length,\n        source: 'synthetic',\n        updateFrequency: `${intervalMinutes} minutes`,\n        coverage: 'Northeast US (based on real weather station data)',\n        timeRange: `Last ${totalHours} hours (${intervalMinutes}min intervals)`,\n        reference: 'IDW interpolation of historical resort weather station data'\n      }\n    };\n\n    const res2 = NextResponse.json(result);\n    res2.headers.set('Cache-Control', 'public, max-age=300');\n    res2.headers.set('Access-Control-Allow-Origin', '*');\n    return res2;\n\n  } catch (error: any) {\n    console.error('[Radar Frames] Error:', error.message);\n    return fallbackResponse();\n  }\n}\n\nfunction fallbackResponse() {\n  // Fallback: Generate synthetic frames if main logic fails\n  const now = Date.now();\n  const frames = [];\n  \n  // Generate 30-minute interval frames for last 48 hours as fallback\n  const totalHours = 48;\n  const intervalMinutes = 30;\n  const totalFrames = (totalHours * 60) / intervalMinutes;\n  \n  for (let i = 0; i < totalFrames; i++) {\n    const timestamp = now - ((totalFrames - 1 - i) * intervalMinutes * 60 * 1000); // Start from oldest to newest\n    frames.push({\n      time: Math.floor(timestamp / 1000), // Convert to seconds for frontend\n      url: `synthetic-${timestamp}`\n    });\n  }\n\n  return NextResponse.json(\n    {\n      radar: {\n        past: frames,\n        source: 'synthetic-fallback'\n      },\n      metadata: {\n        source: 'synthetic-fallback',\n        note: 'Using synthetic fallback frame generation',\n        count: frames.length,\n        timeRange: `Last ${totalHours} hours (${intervalMinutes}min intervals)`\n      }\n    },\n    { status: 200 }\n  );\n}\n"],"names":[],"mappings":";;;;;;;;AAAA;;AAEO,MAAM,UAAU;AAChB,MAAM,aAAa,KAAK,sBAAsB;AAS9C,eAAe,IAAI,OAAgB;IACxC,IAAI;QACF,QAAQ,GAAG,CAAC;QAEZ,+DAA+D;QAC/D,MAAM,MAAM,KAAK,GAAG;QACpB,MAAM,SAAS,EAAE;QAEjB,iEAAiE;QACjE,MAAM,aAAa;QACnB,MAAM,kBAAkB,IAAI,mBAAmB;QAC/C,MAAM,cAAc,YAAY,yBAAyB;QAEzD,IAAK,IAAI,IAAI,GAAG,IAAI,aAAa,IAAK;YACpC,MAAM,YAAY,MAAO,CAAC,cAAc,IAAI,CAAC,IAAI,kBAAkB,KAAK,MAAO,kDAAkD;YACjI,OAAO,IAAI,CAAC;gBACV,MAAM,KAAK,KAAK,CAAC,YAAY;gBAC7B,KAAK,CAAC,UAAU,EAAE,WAAW,CAAC,6BAA6B;YAC7D;QACF;QAEA,QAAQ,GAAG,CAAC,CAAC,yBAAyB,EAAE,OAAO,MAAM,CAAC,+BAA+B,EAAE,WAAW,WAAW,CAAC;QAE9G,MAAM,SAAS;YACb,OAAO;gBACL,MAAM;gBACN,QAAQ;YACV;YACA,UAAU;gBACR,OAAO,OAAO,MAAM;gBACpB,QAAQ;gBACR,iBAAiB,GAAG,gBAAgB,QAAQ,CAAC;gBAC7C,UAAU;gBACV,WAAW,CAAC,KAAK,EAAE,WAAW,QAAQ,EAAE,gBAAgB,cAAc,CAAC;gBACvE,WAAW;YACb;QACF;QAEA,MAAM,OAAO,gJAAY,CAAC,IAAI,CAAC;QAC/B,KAAK,OAAO,CAAC,GAAG,CAAC,iBAAiB;QAClC,KAAK,OAAO,CAAC,GAAG,CAAC,+BAA+B;QAChD,OAAO;IAET,EAAE,OAAO,OAAY;QACnB,QAAQ,KAAK,CAAC,yBAAyB,MAAM,OAAO;QACpD,OAAO;IACT;AACF;AAEA,SAAS;IACP,0DAA0D;IAC1D,MAAM,MAAM,KAAK,GAAG;IACpB,MAAM,SAAS,EAAE;IAEjB,mEAAmE;IACnE,MAAM,aAAa;IACnB,MAAM,kBAAkB;IACxB,MAAM,cAAc,AAAC,aAAa,KAAM;IAExC,IAAK,IAAI,IAAI,GAAG,IAAI,aAAa,IAAK;QACpC,MAAM,YAAY,MAAO,CAAC,cAAc,IAAI,CAAC,IAAI,kBAAkB,KAAK,MAAO,8BAA8B;QAC7G,OAAO,IAAI,CAAC;YACV,MAAM,KAAK,KAAK,CAAC,YAAY;YAC7B,KAAK,CAAC,UAAU,EAAE,WAAW;QAC/B;IACF;IAEA,OAAO,gJAAY,CAAC,IAAI,CACtB;QACE,OAAO;YACL,MAAM;YACN,QAAQ;QACV;QACA,UAAU;YACR,QAAQ;YACR,MAAM;YACN,OAAO,OAAO,MAAM;YACpB,WAAW,CAAC,KAAK,EAAE,WAAW,QAAQ,EAAE,gBAAgB,cAAc,CAAC;QACzE;IACF,GACA;QAAE,QAAQ;IAAI;AAElB"}}]
}