{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/ryanbartell/ski-conditions-aggregator/app/components/ResortMap.tsx"],"sourcesContent":["\"use client\";\n\nimport React, { useEffect, useRef, useState } from 'react';\nimport * as L from 'leaflet';\nimport 'leaflet/dist/leaflet.css';\n\ninterface Resort {\n  id: string;\n  name: string;\n  state: string;\n  lat: number;\n  lon: number;\n  elevationFt?: number;\n  scrapeUrl?: string;\n  conditionsUrl?: string;\n}\n\ninterface ResortConditions {\n  resortId: string;\n  snowDepth: number;\n  recentSnowfall: number;\n  recentRainfall?: number;\n  weeklySnowfall?: number;\n  weeklyRainfall?: number;\n  baseTemp: number;\n  windSpeed: number;\n  visibility: string;\n  timestamp: string;\n}\n\ninterface ResortMapProps {\n  resorts?: Resort[];\n  conditions?: Record<string, ResortConditions | null>;\n  loading?: Record<string, boolean>;\n  errors?: Record<string, string | null>;\n}\n\nconst ResortMap: React.FC<ResortMapProps> = ({\n  resorts = [],\n  conditions = {},\n  loading = {},\n  errors = {},\n}) => {\n  const containerRef = useRef<HTMLDivElement | null>(null);\n  const mapRef = useRef<L.Map | null>(null);\n  const markersRef = useRef<Map<string, L.CircleMarker>>(new Map());\n  const canvasRef = useRef<HTMLCanvasElement | null>(null);\n  const popupsRef = useRef<Map<string, L.Popup>>(new Map());\n  \n  const [radarPlaying, setRadarPlaying] = useState(true);\n  const [radarSpeedMs, setRadarSpeedMs] = useState(1500);\n  const [radarOpacity, setRadarOpacity] = useState(0.6);\n  const [radarFramesAvailable, setRadarFramesAvailable] = useState(false);\n  const [frameCount, setFrameCount] = useState(0);\n  const [loadingStatus, setLoadingStatus] = useState('Initializing map...');\n  const [mapReady, setMapReady] = useState(false);\n  const [selectedResort, setSelectedResort] = useState<{ resort: Resort; conditions: ResortConditions } | null>(null);\n  const [radarFrameTimes, setRadarFrameTimes] = useState<Array<number>>([]);\n  const [radarIndex, setRadarIndex] = useState(0);\n\n  // FIXED: Properly initialize radarFramesRef as a Ref, not a boolean\n  const radarFramesRef = useRef<Array<{ url: string; time?: number }>>([]); \n  const radarIndexRef = useRef(0);\n  const radarPlayingRef = useRef(true);\n  const tileBitmapCache = useRef<Map<string, ImageBitmap>>(new Map());\n  const frameCanvasCache = useRef<Map<string, HTMLCanvasElement>>(new Map());\n  const rafRef = useRef<number | null>(null);\n  const lastRenderTimeRef = useRef(0);\n  const mapPanZoomRef = useRef({ panning: false, zooming: false });\n\n  // Initialize map\n  useEffect(() => {\n    if (mapRef.current) return;\n    if (!containerRef.current) return;\n    if (containerRef.current.innerHTML !== '') containerRef.current.innerHTML = '';\n\n    console.log('[Map] Starting initialization...');\n\n    try {\n      const map = L.map(containerRef.current, {\n        center: [43.5, -71.5],\n        zoom: 7,\n        scrollWheelZoom: true,\n      });\n\n      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\n        attribution: '&copy; OpenStreetMap contributors',\n        maxZoom: 19,\n      }).addTo(map);\n\n      mapRef.current = map;\n\n      if (!map.getPane('radarPane')) map.createPane('radarPane');\n      const radarPane = map.getPane('radarPane') as HTMLElement;\n      radarPane.style.zIndex = '400';\n      radarPane.style.pointerEvents = 'none';\n\n      const markerPane = map.getPane('markerPane') as HTMLElement;\n      markerPane.style.zIndex = '700';\n\n      const container2 = document.createElement('div');\n      container2.style.position = 'absolute';\n      container2.style.left = '0';\n      container2.style.top = '0';\n      container2.style.width = '100%';\n      container2.style.height = '100%';\n      container2.style.pointerEvents = 'none';\n\n      const canvas = document.createElement('canvas');\n      canvas.style.position = 'absolute';\n      canvas.style.left = '0';\n      canvas.style.top = '0';\n      canvas.style.pointerEvents = 'none';\n      canvas.style.opacity = String(radarOpacity);\n      canvas.style.willChange = 'opacity';\n\n      container2.appendChild(canvas);\n      radarPane.appendChild(container2);\n      canvasRef.current = canvas;\n\n      // --- Fix: Always force canvas to match map size, even if Leaflet/React race ---\n      const resizeCanvas = () => {\n        if (!canvas || !map) return;\n        const size = map.getSize();\n        const dpr = window.devicePixelRatio || 1;\n        // Only resize if needed (avoid flicker)\n        if (canvas.width !== size.x * dpr || canvas.height !== size.y * dpr) {\n          canvas.width = size.x * dpr;\n          canvas.height = size.y * dpr;\n          canvas.style.width = `${size.x}px`;\n          canvas.style.height = `${size.y}px`;\n          const ctx = canvas.getContext('2d');\n          if (ctx) ctx.setTransform(dpr, 0, 0, dpr, 0, 0);\n          frameCanvasCache.current.clear();\n          console.log('[RadarCanvas] Resized to', size.x, size.y, 'dpr', dpr);\n        }\n      };\n\n      // Force resize on next animation frame after mount\n      requestAnimationFrame(resizeCanvas);\n      map.on('resize', resizeCanvas);\n      // Also force resize after 200ms in case of late layout\n      setTimeout(resizeCanvas, 200);\n\n      map.on('movestart', () => { mapPanZoomRef.current.panning = true; });\n      map.on('moveend', () => { mapPanZoomRef.current.panning = false; frameCanvasCache.current.clear(); });\n      map.on('zoomstart', () => { mapPanZoomRef.current.zooming = true; });\n      map.on('zoomend', () => { mapPanZoomRef.current.zooming = false; frameCanvasCache.current.clear(); });\n\n      setTimeout(() => map.invalidateSize(), 200);\n\n      console.log('[Map] Initialization complete');\n      setMapReady(true);\n      setLoadingStatus('Map ready. Loading frames...');\n    } catch (error) {\n      console.error('[Map] Initialization failed:', error);\n      setLoadingStatus('Map initialization failed');\n    }\n  }, []);\n\n  // Load radar frames\n  useEffect(() => {\n    if (!mapReady) return;\n\n    const loadFrames = async () => {\n      try {\n        console.log('[Frames] Starting frame load...');\n        const startTime = Date.now();\n        const res = await fetch('/api/radar/frames');\n        if (!res.ok) throw new Error(`API returned ${res.status}`);\n\n        const data = await res.json();\n        const layers = data?.radar?.past || [];\n        const loadTime = Date.now() - startTime;\n        console.log(`[Frames] Loaded ${layers.length} frames in ${loadTime}ms, source: ${data?.radar?.source}`);\n\n        if (layers.length === 0) {\n          console.warn('[Frames] No frames returned from API');\n          setLoadingStatus('No radar frames available');\n          return;\n        }\n\n        const frameObjects = layers.map((layer: any) => {\n          if (typeof layer === 'string') {\n            return { url: layer, time: 0 };\n          } else {\n            return { url: layer.url, time: layer.time };\n          }\n        });\n\n        // Extract times for timeline\n        const frameTimes = frameObjects.map((f: { url: string; time: number }) => typeof f.time === 'number' ? f.time : 0);\n\n        radarFramesRef.current = frameObjects;\n        setFrameCount(frameObjects.length);\n        setRadarFramesAvailable(frameObjects.length > 0);\n        setRadarFrameTimes(frameTimes);\n\n        const sourceLabel = data?.radar?.source === 'rainviewer-48h' ? '48h RainViewer' : '1h Mesonet (fallback)';\n        setLoadingStatus(`Ready: ${frameObjects.length} frames (${sourceLabel})`);\n        console.log(`[Frames] Setup complete: ${frameObjects.length} frames, times range: ${new Date(Math.min(...frameTimes)).toLocaleTimeString()} - ${new Date(Math.max(...frameTimes)).toLocaleTimeString()}`);\n\n        // Force initial radar render after frames load\n        setTimeout(() => {\n          if (canvasRef.current && mapRef.current) {\n            const canvas = canvasRef.current;\n            const map = mapRef.current;\n            const size = map.getSize();\n            const dpr = window.devicePixelRatio || 1;\n            canvas.width = size.x * dpr;\n            canvas.height = size.y * dpr;\n            canvas.style.width = `${size.x}px`;\n            canvas.style.height = `${size.y}px`;\n            const ctx = canvas.getContext('2d');\n            if (ctx) ctx.setTransform(dpr, 0, 0, dpr, 0, 0);\n            frameCanvasCache.current.clear();\n            console.log('[Frames] Forced initial canvas resize after frame load');\n          }\n        }, 100);\n      } catch (e) {\n        console.error('[Frames] Load failed:', e);\n        setLoadingStatus(`Failed to load frames: ${e}`);\n      }\n    };\n\n    loadFrames();\n  }, [mapReady]);\n\n  // Add resort markers with proper popup binding\n  useEffect(() => {\n    if (!mapRef.current || resorts.length === 0) return;\n\n    const map = mapRef.current;\n    const activeIds = new Set(resorts.map(r => r.id));\n\n    // Remove old markers\n    markersRef.current.forEach((marker, id) => {\n      if (!activeIds.has(id)) {\n        marker.remove();\n        markersRef.current.delete(id);\n        popupsRef.current.delete(id);\n      }\n    });\n\n    // Add or update markers\n    resorts.forEach((resort) => {\n      const cond = conditions[resort.id];\n      const err = errors[resort.id];\n      const isLoading = loading[resort.id];\n\n      let markerColor = '#9CA3AF';\n      let markerRadius = 8;\n      let markerWeight = 2;\n\n      if (err) {\n        markerColor = '#EF4444';\n        markerRadius = 7;\n      } else if (cond) {\n        if (cond.recentSnowfall >= 12) {\n          markerColor = '#0EA5E9'; markerRadius = 12; markerWeight = 3;\n        } else if (cond.recentSnowfall >= 6) {\n          markerColor = '#06B6D4'; markerRadius = 10; markerWeight = 3;\n        } else if (cond.recentSnowfall >= 1) {\n          markerColor = '#3B82F6'; markerRadius = 9;\n        } else {\n          markerColor = '#F59E0B'; markerRadius = 8;\n        }\n      }\n\n      // Update existing marker style\n      if (markersRef.current.has(resort.id)) {\n        const existing = markersRef.current.get(resort.id)!;\n        existing.setStyle({ fillColor: markerColor, radius: markerRadius, weight: markerWeight });\n        \n        // Update popup content\n        if (popupsRef.current.has(resort.id)) {\n          const popup = popupsRef.current.get(resort.id)!;\n          popup.setContent(buildPopupContent(resort, cond, err, isLoading));\n        }\n        return;\n      }\n\n      // Create new marker\n      const marker = L.circleMarker([resort.lat, resort.lon], {\n        radius: markerRadius,\n        fillColor: markerColor,\n        color: '#FFFFFF',\n        weight: markerWeight,\n        opacity: 1,\n        fillOpacity: 0.9,\n        pane: 'markerPane',\n      }).addTo(map);\n\n      // Create popup content\n      const popupContent = buildPopupContent(resort, cond, err, isLoading);\n      const popup = L.popup({ maxWidth: 320, closeButton: true }).setContent(popupContent);\n      \n      // Bind popup to marker\n      marker.bindPopup(popup);\n      popupsRef.current.set(resort.id, popup);\n\n      // Add event listeners\n      marker.on('click', (e) => {\n        if (cond) {\n          setSelectedResort({ resort, conditions: cond });\n        }\n        // Ensure popup opens\n        setTimeout(() => {\n          marker.openPopup();\n        }, 0);\n      });\n\n  marker.on('mouseover', function (this: L.CircleMarker) { this.setRadius(markerRadius * 1.3); });\n  marker.on('mouseout', function (this: L.CircleMarker) { this.setRadius(markerRadius); });\n\n      markersRef.current.set(resort.id, marker);\n    });\n  }, [resorts, conditions, loading, errors]);\n\n  // Build popup content\n  const buildPopupContent = (\n    resort: Resort,\n    cond: ResortConditions | null | undefined,\n    err: string | null | undefined,\n    isLoading: boolean | undefined\n  ): HTMLElement => {\n    const div = document.createElement('div');\n    div.style.cssText = 'font-size: 13px; font-family: system-ui; padding: 8px; min-width: 240px;';\n    \n    let html = `<div style=\"font-weight: bold; font-size: 15px; margin-bottom: 12px; color: #1f2937;\">${resort.name}, ${resort.state}</div>`;\n    \n    if (isLoading) {\n      html += `<div style=\"color: #666; padding: 8px; background: #f3f4f6; border-radius: 4px;\">‚è≥ Loading conditions...</div>`;\n    } else if (err) {\n      html += `<div style=\"color: #DC2626; padding: 8px; background: #fee2e2; border-radius: 4px;\">‚ùå Error: ${err}</div>`;\n    } else if (cond) {\n      html += `<div style=\"display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-bottom: 12px;\">`;\n      html += `<div style=\"background: #dbeafe; padding: 8px; border-radius: 4px; border-left: 3px solid #0EA5E9;\"><div style=\"font-size: 11px; color: #0c4a6e; font-weight: 600;\">1-Day Snow</div><div style=\"color: #0EA5E9; font-weight: bold; font-size: 16px;\">${cond.recentSnowfall}\"</div></div>`;\n      html += `<div style=\"background: #f0fdf4; padding: 8px; border-radius: 4px; border-left: 3px solid #22c55e;\"><div style=\"font-size: 11px; color: #166534; font-weight: 600;\">Base Depth</div><div style=\"color: #22c55e; font-weight: bold; font-size: 16px;\">${cond.snowDepth}\"</div></div>`;\n      html += `<div style=\"background: #eff6ff; padding: 8px; border-radius: 4px; border-left: 3px solid #3B82F6;\"><div style=\"font-size: 11px; color: #1e40af; font-weight: 600;\">7-Day Snow</div><div style=\"color: #3B82F6; font-weight: bold; font-size: 16px;\">${cond.weeklySnowfall || 'N/A'}\"</div></div>`;\n      html += `<div style=\"background: #fef3c7; padding: 8px; border-radius: 4px; border-left: 3px solid #F59E0B;\"><div style=\"font-size: 11px; color: #92400e; font-weight: 600;\">7-Day Rain</div><div style=\"color: #F59E0B; font-weight: bold; font-size: 16px;\">${cond.weeklyRainfall ? cond.weeklyRainfall.toFixed(1) : 'N/A'}\"</div></div>`;\n      html += `</div>`;\n      html += `<div style=\"border-top: 1px solid #e5e7eb; padding-top: 10px; margin-bottom: 10px;\">`;\n      html += `<div style=\"font-size: 12px; color: #374151; margin-bottom: 6px;\"><b>üí® Wind:</b> ${cond.windSpeed} mph</div>`;\n      html += `<div style=\"font-size: 12px; color: #374151;\"><b>üëÅÔ∏è Visibility:</b> ${cond.visibility}</div>`;\n      html += `</div>`;\n      \n      if (resort.conditionsUrl || resort.scrapeUrl) {\n        const url = resort.conditionsUrl || resort.scrapeUrl;\n        html += `<a href=\"${url}\" target=\"_blank\" rel=\"noopener noreferrer\" style=\"display: block; background: #0EA5E9; color: white; padding: 10px 12px; border-radius: 4px; font-weight: 600; font-size: 12px; text-decoration: none; text-align: center; cursor: pointer; margin-top: 8px; transition: background 0.2s;\">üìã View Full Report ‚Üí</a>`;\n      }\n    }\n    \n    div.innerHTML = html;\n    return div;\n  };\n\n  // Get tile with connection pooling\n  const getTileBitmap = async (\n    layer: string | { url: string; time?: number },\n    z: number,\n    x: number,\n    y: number\n  ): Promise<ImageBitmap | null> => {\n    const layerStr = typeof layer === 'string' ? layer : layer.url;\n    const key = `${layerStr}_${z}_${x}_${y}`;\n    if (tileBitmapCache.current.has(key)) return tileBitmapCache.current.get(key) || null;\n\n    try {\n      const url = `/api/radar/tile?layer=${encodeURIComponent(layerStr)}&z=${z}&x=${x}&y=${y}`;\n      const resp = await fetch(url, {\n        signal: AbortSignal.timeout(5000), // 5 second timeout\n      });\n      if (!resp.ok) return null;\n\n      const blob = await resp.blob();\n      if (blob.size === 0) return null;\n\n      const bitmap = await createImageBitmap(blob);\n      tileBitmapCache.current.set(key, bitmap);\n\n      if (tileBitmapCache.current.size > 256) {\n        const firstKey = tileBitmapCache.current.keys().next().value;\n        if (firstKey) tileBitmapCache.current.delete(firstKey);\n      }\n      return bitmap;\n    } catch (e) {\n      return null;\n    }\n  };\n\n  // Render frame to canvas\n  const renderFrameToCanvas = async (\n    layer: string | { url: string; time?: number },\n    z: number,\n    widthPx: number,\n    heightPx: number,\n    key: string\n  ): Promise<HTMLCanvasElement | null> => {\n    if (frameCanvasCache.current.has(key)) return frameCanvasCache.current.get(key) || null;\n\n    try {\n      const dpr = window.devicePixelRatio || 1;\n      const c = document.createElement('canvas');\n      c.width = widthPx * dpr;\n      c.height = heightPx * dpr;\n\n      const ctx = c.getContext('2d');\n      if (!ctx) return null;\n      ctx.setTransform(dpr, 0, 0, dpr, 0, 0);\n\n      const map = mapRef.current;\n      if (!map) return null;\n\n      const size = map.getSize();\n      const center = map.getCenter();\n      const centerWorld = (map as any).project(center, z);\n      const leftWorldX = centerWorld.x - size.x / 2;\n      const topWorldY = centerWorld.y - size.y / 2;\n\n      const xMin = Math.floor(leftWorldX / 256);\n      const xMax = Math.floor((leftWorldX + size.x) / 256);\n      const yMin = Math.floor(topWorldY / 256);\n      const yMax = Math.floor((topWorldY + size.y) / 256);\n      const tilesAcross = Math.pow(2, z);\n\n      // Fetch tiles in parallel with controlled concurrency\n      const tilePromises: Promise<void>[] = [];\n      for (let tx = xMin; tx <= xMax; tx++) {\n        for (let ty = yMin; ty <= yMax; ty++) {\n          const wrapX = ((tx % tilesAcross) + tilesAcross) % tilesAcross;\n          const wrapY = ty;\n          if (wrapY < 0 || wrapY >= tilesAcross) continue;\n\n          tilePromises.push(\n            (async () => {\n              const bitmap = await getTileBitmap(layer, z, wrapX, wrapY);\n              if (!bitmap) return;\n\n              const tileWorldX = tx * 256;\n              const tileWorldY = ty * 256;\n              const canvasX = (tileWorldX - leftWorldX) * dpr;\n              const canvasY = (tileWorldY - topWorldY) * dpr;\n              ctx.drawImage(bitmap, canvasX, canvasY, 256 * dpr, 256 * dpr);\n            })()\n          );\n        }\n      }\n\n      // Wait for all tiles with concurrency limit\n      const limit = 6;\n      for (let i = 0; i < tilePromises.length; i += limit) {\n        await Promise.all(tilePromises.slice(i, i + limit));\n      }\n\n      frameCanvasCache.current.set(key, c);\n      if (frameCanvasCache.current.size > 32) {\n        const firstKey = frameCanvasCache.current.keys().next().value;\n        if (firstKey) frameCanvasCache.current.delete(firstKey);\n      }\n      return c;\n    } catch (e) {\n      return null;\n    }\n  };\n\n  // Animation loop - optimized\n  useEffect(() => {\n    let lastTime = performance.now();\n    let progress = 0;\n\n    const step = async (now: number) => {\n      const c = canvasRef.current;\n      if (!c) { rafRef.current = requestAnimationFrame(step); return; }\n\n      // --- Fix: Always force canvas to match map size before drawing ---\n      const map = mapRef.current;\n      if (map && c) {\n        const size = map.getSize();\n        const dpr = window.devicePixelRatio || 1;\n        if (c.width !== size.x * dpr || c.height !== size.y * dpr) {\n          c.width = size.x * dpr;\n          c.height = size.y * dpr;\n          c.style.width = `${size.x}px`;\n          c.style.height = `${size.y}px`;\n          const ctx = c.getContext('2d');\n          if (ctx) ctx.setTransform(dpr, 0, 0, dpr, 0, 0);\n          frameCanvasCache.current.clear();\n          console.log('[RadarCanvas] Animation forced resize', size.x, size.y, 'dpr', dpr);\n        }\n      }\n\n      const ctx = c.getContext('2d');\n      if (!ctx) { rafRef.current = requestAnimationFrame(step); return; }\n\n      if (!radarPlayingRef.current || !radarFramesAvailable) { \n        rafRef.current = requestAnimationFrame(step); \n        return; \n      }\n\n      const frames = radarFramesRef.current;\n      if (frames.length === 0) { rafRef.current = requestAnimationFrame(step); return; }\n\n      // Skip during pan/zoom\n      if (mapPanZoomRef.current.panning || mapPanZoomRef.current.zooming) {\n        rafRef.current = requestAnimationFrame(step);\n        return;\n      }\n\n      const elapsed = now - lastTime;\n      lastTime = now;\n      progress += elapsed;\n\n      const dur = radarSpeedMs;\n      const t = Math.min(1, progress / dur);\n      const idx = radarIndexRef.current % frames.length;\n      const nextIdx = (idx + 1) % frames.length;\n\n      setRadarIndex(idx); // For timeline UI\n\n      // Throttle to 20fps for radar\n      const timeSinceLastRender = now - lastRenderTimeRef.current;\n      if (timeSinceLastRender < 50) {\n        rafRef.current = requestAnimationFrame(step);\n        return;\n      }\n\n      try {\n        // --- Canada fix: always show full radar, don't restrict by bounds ---\n        // (No code change needed here, but this comment documents the intent)\n\n        const z = map ? Math.max(0, Math.round(map.getZoom() || 5)) : 7;\n        const size = map ? map.getSize() : { x: 800, y: 600 };\n        const keyPrev = `${frames[idx].url}_${z}_${size.x}_${size.y}`;\n        const keyNext = `${frames[nextIdx].url}_${z}_${size.x}_${size.y}`;\n\n        ctx.clearRect(0, 0, c.width, c.height);\n\n        const prevC = await renderFrameToCanvas(frames[idx], z, size.x, size.y, keyPrev);\n        const nextC = await renderFrameToCanvas(frames[nextIdx], z, size.x, size.y, keyNext);\n\n        if (prevC) ctx.drawImage(prevC, 0, 0);\n        if (nextC) {\n          ctx.globalAlpha = t;\n          ctx.drawImage(nextC, 0, 0);\n          ctx.globalAlpha = 1;\n        }\n\n        lastRenderTimeRef.current = now;\n\n        if (progress >= dur) {\n          progress = 0;\n          radarIndexRef.current = nextIdx;\n          console.log(`[Radar] Frame ${idx} ‚Üí ${nextIdx}/${frames.length}`);\n        }\n      } catch (e) { console.error('[RadarCanvas] Render error', e); }\n\n      rafRef.current = requestAnimationFrame(step);\n    };\n\n    rafRef.current = requestAnimationFrame(step);\n    return () => { if (rafRef.current) cancelAnimationFrame(rafRef.current); };\n  }, [radarFramesAvailable, radarSpeedMs]);\n\n  useEffect(() => {\n    if (canvasRef.current) canvasRef.current.style.opacity = String(radarOpacity);\n  }, [radarOpacity]);\n\n  return (\n    <div className=\"relative w-full h-screen bg-gray-100 flex flex-col\">\n      <div ref={containerRef} className=\"flex-1 w-full\" style={{ position: 'relative', width: '100%', height: '100%', minHeight: '400px' }} />\n\n        <div className=\"absolute top-4 left-4 z-[99999] bg-white/95 rounded-lg p-4 shadow-lg max-w-xs\">\n          <div className=\"font-bold mb-2 text-gray-800 text-sm\">\n            üõ∞ {radarFramesAvailable ? 'Radar 48h' : 'Loading Radar...'}\n          </div>\n          {radarFramesAvailable ? (\n            <>\n              <div className=\"flex gap-2 mb-3\">\n                <button onClick={() => { setRadarPlaying(true); radarPlayingRef.current = true; }} className=\"px-3 py-1 bg-blue-500 text-white rounded text-sm hover:bg-blue-600 font-semibold\">‚ñ∂ Play</button>\n                <button onClick={() => { setRadarPlaying(false); radarPlayingRef.current = false; }} className=\"px-3 py-1 bg-gray-400 text-white rounded text-sm hover:bg-gray-500 font-semibold\">‚è∏ Pause</button>\n              </div>\n              <div className=\"mb-3\"><label className=\"text-xs font-semibold text-gray-700 block mb-1\">Speed</label><input type=\"range\" min=\"500\" max=\"3000\" step=\"100\" value={radarSpeedMs} onChange={(e) => setRadarSpeedMs(Number(e.target.value))} className=\"w-full\" /></div>\n              <div className=\"mb-3\"><label className=\"text-xs font-semibold text-gray-700 block mb-1\">Opacity</label><input type=\"range\" min=\"0\" max=\"1\" step=\"0.05\" value={radarOpacity} onChange={(e) => setRadarOpacity(Number(e.target.value))} className=\"w-full\" /></div>\n              {/* Timeline UI */}\n              {radarFrameTimes.length > 1 && (\n                <div className=\"mb-3\">\n                  <label className=\"text-xs font-semibold text-gray-700 block mb-1\">Timeline</label>\n                  <div className=\"flex items-center gap-2\">\n                    <span className=\"text-[10px] text-gray-500\">{radarFrameTimes[0] ? new Date(radarFrameTimes[0] * 1000).toLocaleString() : ''}</span>\n                    <input\n                      type=\"range\"\n                      min={0}\n                      max={radarFrameTimes.length - 1}\n                      value={radarIndex}\n                      onChange={e => {\n                        const idx = Number(e.target.value);\n                        radarIndexRef.current = idx;\n                        setRadarIndex(idx);\n                      }}\n                      className=\"flex-1\"\n                    />\n                    <span className=\"text-[10px] text-gray-500\">{radarFrameTimes[radarFrameTimes.length - 1] ? new Date(radarFrameTimes[radarFrameTimes.length - 1] * 1000).toLocaleString() : ''}</span>\n                  </div>\n                </div>\n              )}\n            </>\n          ) : (\n            <div className=\"text-xs text-gray-600 mb-3\">\n              <div className=\"animate-pulse\">‚è≥ {loadingStatus}</div>\n              <div className=\"mt-2 text-[10px] text-gray-500\">\n                This may take a few seconds...\n              </div>\n            </div>\n          )}\n          <div className=\"text-xs text-gray-700 border-t pt-2\"><div>Status: {loadingStatus}</div><div>Markers: {markersRef.current.size}/43</div></div>\n        </div>      {selectedResort && (\n        <div className=\"absolute top-4 right-4 z-[99999] bg-white/95 rounded-lg p-5 shadow-lg max-w-sm\">\n          <button onClick={() => setSelectedResort(null)} className=\"absolute top-2 right-2 text-gray-500 hover:text-gray-700 text-lg font-bold\">‚úï</button>\n          <div className=\"font-bold text-gray-800 text-base mb-3\">üìä {selectedResort.resort.name}</div>\n          <div className=\"space-y-2 text-sm\">\n            <div className=\"flex justify-between items-center\">\n              <span className=\"text-gray-700 font-semibold\">24h Snowfall:</span>\n              <span className=\"text-blue-600 font-bold text-lg\">{selectedResort.conditions.recentSnowfall}\"</span>\n            </div>\n            {selectedResort.conditions.recentRainfall && selectedResort.conditions.recentRainfall > 0 && (\n              <div className=\"flex justify-between items-center\">\n                <span className=\"text-gray-700 font-semibold\">24h Rainfall:</span>\n                <span className=\"text-blue-400 font-bold text-lg\">{selectedResort.conditions.recentRainfall.toFixed(2)}\"</span>\n              </div>\n            )}\n            <div className=\"flex justify-between items-center\">\n              <span className=\"text-gray-700 font-semibold\">Weekly Snow:</span>\n              <span className=\"text-blue-500 font-bold text-lg\">{selectedResort.conditions.weeklySnowfall || 'N/A'}\"</span>\n            </div>\n            {selectedResort.conditions.weeklyRainfall && selectedResort.conditions.weeklyRainfall > 0 && (\n              <div className=\"flex justify-between items-center\">\n                <span className=\"text-gray-700 font-semibold\">Weekly Rain:</span>\n                <span className=\"text-blue-300 font-bold text-lg\">{selectedResort.conditions.weeklyRainfall.toFixed(2)}\"</span>\n              </div>\n            )}\n            <div className=\"flex justify-between items-center\">\n              <span className=\"text-gray-700 font-semibold\">Base Depth:</span>\n              <span className=\"text-gray-700 font-bold text-lg\">{selectedResort.conditions.snowDepth}\"</span>\n            </div>\n            <div className=\"flex justify-between items-center\">\n              <span className=\"text-gray-700 font-semibold\">Temperature:</span>\n              <span className=\"text-red-600 font-bold text-lg\">{selectedResort.conditions.baseTemp}¬∞F</span>\n            </div>\n            <div className=\"flex justify-between items-center\">\n              <span className=\"text-gray-700 font-semibold\">Wind:</span>\n              <span className=\"text-gray-700 font-bold\">{selectedResort.conditions.windSpeed} mph</span>\n            </div>\n            <div className=\"flex justify-between items-center\">\n              <span className=\"text-gray-700 font-semibold\">Visibility:</span>\n              <span className=\"text-gray-700 font-bold\">{selectedResort.conditions.visibility}</span>\n            </div>\n            {(selectedResort.resort.conditionsUrl || selectedResort.resort.scrapeUrl) && (\n              <a \n                href={selectedResort.resort.conditionsUrl || selectedResort.resort.scrapeUrl} \n                target=\"_blank\" \n                rel=\"noopener noreferrer\"\n                className=\"block mt-4 text-center bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-lg transition\"\n              >\n                View Full Report ‚Üí\n              </a>\n            )}\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default ResortMap;"],"names":[],"mappings":"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"}}]
}