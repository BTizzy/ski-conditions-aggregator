module.exports=[88947,(t,e,i)=>{e.exports=t.x("stream",()=>require("stream"))},6461,(t,e,i)=>{e.exports=t.x("zlib",()=>require("zlib"))},32921,(t,e,i)=>{"use strict";let r=t.r(24361),n=t.r(88947),s=e.exports=function(){n.call(this),this._buffers=[],this._buffered=0,this._reads=[],this._paused=!1,this._encoding="utf8",this.writable=!0};r.inherits(s,n),s.prototype.read=function(t,e){this._reads.push({length:Math.abs(t),allowLess:t<0,func:e}),process.nextTick((function(){this._process(),this._paused&&this._reads&&this._reads.length>0&&(this._paused=!1,this.emit("drain"))}).bind(this))},s.prototype.write=function(t,e){let i;return this.writable?(i=Buffer.isBuffer(t)?t:Buffer.from(t,e||this._encoding),this._buffers.push(i),this._buffered+=i.length,this._process(),this._reads&&0===this._reads.length&&(this._paused=!0),this.writable&&!this._paused):(this.emit("error",Error("Stream not writable")),!1)},s.prototype.end=function(t,e){t&&this.write(t,e),this.writable=!1,this._buffers&&(0===this._buffers.length?this._end():(this._buffers.push(null),this._process()))},s.prototype.destroySoon=s.prototype.end,s.prototype._end=function(){this._reads.length>0&&this.emit("error",Error("Unexpected end of input")),this.destroy()},s.prototype.destroy=function(){this._buffers&&(this.writable=!1,this._reads=null,this._buffers=null,this.emit("close"))},s.prototype._processReadAllowingLess=function(t){this._reads.shift();let e=this._buffers[0];e.length>t.length?(this._buffered-=t.length,this._buffers[0]=e.slice(t.length),t.func.call(this,e.slice(0,t.length))):(this._buffered-=e.length,this._buffers.shift(),t.func.call(this,e))},s.prototype._processRead=function(t){this._reads.shift();let e=0,i=0,r=Buffer.alloc(t.length);for(;e<t.length;){let n=this._buffers[i++],s=Math.min(n.length,t.length-e);n.copy(r,e,0,s),e+=s,s!==n.length&&(this._buffers[--i]=n.slice(s))}i>0&&this._buffers.splice(0,i),this._buffered-=t.length,t.func.call(this,r)},s.prototype._process=function(){try{for(;this._buffered>0&&this._reads&&this._reads.length>0;){let t=this._reads[0];if(t.allowLess)this._processReadAllowingLess(t);else if(this._buffered>=t.length)this._processRead(t);else break}this._buffers&&!this.writable&&this._end()}catch(t){this.emit("error",t)}}},3469,(t,e,i)=>{"use strict";let r=[{x:[0],y:[0]},{x:[4],y:[0]},{x:[0,4],y:[4]},{x:[2,6],y:[0,4]},{x:[0,2,4,6],y:[2,6]},{x:[1,3,5,7],y:[0,2,4,6]},{x:[0,1,2,3,4,5,6,7],y:[1,3,5,7]}];i.getImagePasses=function(t,e){let i=[],n=t%8,s=e%8,a=(t-n)/8,o=(e-s)/8;for(let t=0;t<r.length;t++){let e=r[t],h=a*e.x.length,l=o*e.y.length;for(let t=0;t<e.x.length;t++)if(e.x[t]<n)h++;else break;for(let t=0;t<e.y.length;t++)if(e.y[t]<s)l++;else break;h>0&&l>0&&i.push({width:h,height:l,index:t})}return i},i.getInterlaceIterator=function(t){return function(e,i,n){let s=e%r[n].x.length,a=(e-s)/r[n].x.length*8+r[n].x[s],o=i%r[n].y.length;return 4*a+((i-o)/r[n].y.length*8+r[n].y[o])*t*4}}},39548,(t,e,i)=>{"use strict";e.exports=function(t,e,i){let r=t+e-i,n=Math.abs(r-t),s=Math.abs(r-e),a=Math.abs(r-i);return n<=s&&n<=a?t:s<=a?e:i}},50617,(t,e,i)=>{"use strict";let r=t.r(3469),n=t.r(39548);function s(t,e,i){let r=t*e;return 8!==i&&(r=Math.ceil(r/(8/i))),r}let a=e.exports=function(t,e){let i=t.width,n=t.height,a=t.interlace,o=t.bpp,h=t.depth;if(this.read=e.read,this.write=e.write,this.complete=e.complete,this._imageIndex=0,this._images=[],a){let t=r.getImagePasses(i,n);for(let e=0;e<t.length;e++)this._images.push({byteWidth:s(t[e].width,o,h),height:t[e].height,lineIndex:0})}else this._images.push({byteWidth:s(i,o,h),height:n,lineIndex:0});8===h?this._xComparison=o:16===h?this._xComparison=2*o:this._xComparison=1};a.prototype.start=function(){this.read(this._images[this._imageIndex].byteWidth+1,this._reverseFilterLine.bind(this))},a.prototype._unFilterType1=function(t,e,i){let r=this._xComparison,n=r-1;for(let s=0;s<i;s++){let i=t[1+s],a=s>n?e[s-r]:0;e[s]=i+a}},a.prototype._unFilterType2=function(t,e,i){let r=this._lastLine;for(let n=0;n<i;n++){let i=t[1+n],s=r?r[n]:0;e[n]=i+s}},a.prototype._unFilterType3=function(t,e,i){let r=this._xComparison,n=r-1,s=this._lastLine;for(let a=0;a<i;a++){let i=t[1+a],o=s?s[a]:0,h=Math.floor(((a>n?e[a-r]:0)+o)/2);e[a]=i+h}},a.prototype._unFilterType4=function(t,e,i){let r=this._xComparison,s=r-1,a=this._lastLine;for(let o=0;o<i;o++){let i=t[1+o],h=a?a[o]:0,l=n(o>s?e[o-r]:0,h,o>s&&a?a[o-r]:0);e[o]=i+l}},a.prototype._reverseFilterLine=function(t){let e,i=t[0],r=this._images[this._imageIndex],n=r.byteWidth;if(0===i)e=t.slice(1,n+1);else switch(e=Buffer.alloc(n),i){case 1:this._unFilterType1(t,e,n);break;case 2:this._unFilterType2(t,e,n);break;case 3:this._unFilterType3(t,e,n);break;case 4:this._unFilterType4(t,e,n);break;default:throw Error("Unrecognised filter type - "+i)}this.write(e),r.lineIndex++,r.lineIndex>=r.height?(this._lastLine=null,this._imageIndex++,r=this._images[this._imageIndex]):this._lastLine=e,r?this.read(r.byteWidth+1,this._reverseFilterLine.bind(this)):(this._lastLine=null,this.complete())}},44502,(t,e,i)=>{"use strict";let r=t.r(24361),n=t.r(32921),s=t.r(50617),a=e.exports=function(t){n.call(this);let e=[],i=this;this._filter=new s(t,{read:this.read.bind(this),write:function(t){e.push(t)},complete:function(){i.emit("complete",Buffer.concat(e))}}),this._filter.start()};r.inherits(a,n)},58461,(t,e,i)=>{"use strict";e.exports={PNG_SIGNATURE:[137,80,78,71,13,10,26,10],TYPE_IHDR:0x49484452,TYPE_IEND:0x49454e44,TYPE_IDAT:0x49444154,TYPE_PLTE:0x504c5445,TYPE_tRNS:0x74524e53,TYPE_gAMA:0x67414d41,COLORTYPE_GRAYSCALE:0,COLORTYPE_PALETTE:1,COLORTYPE_COLOR:2,COLORTYPE_ALPHA:4,COLORTYPE_PALETTE_COLOR:3,COLORTYPE_COLOR_ALPHA:6,COLORTYPE_TO_BPP_MAP:{0:1,2:3,3:1,4:2,6:4},GAMMA_DIVISION:1e5}},37754,(t,e,i)=>{"use strict";let r=[];for(let t=0;t<256;t++){let e=t;for(let t=0;t<8;t++)1&e?e=0xedb88320^e>>>1:e>>>=1;r[t]=e}let n=e.exports=function(){this._crc=-1};n.prototype.write=function(t){for(let e=0;e<t.length;e++)this._crc=r[(this._crc^t[e])&255]^this._crc>>>8;return!0},n.prototype.crc32=function(){return -1^this._crc},n.crc32=function(t){let e=-1;for(let i=0;i<t.length;i++)e=r[(e^t[i])&255]^e>>>8;return -1^e}},89955,(t,e,i)=>{"use strict";let r=t.r(58461),n=t.r(37754),s=e.exports=function(t,e){this._options=t,t.checkCRC=!1!==t.checkCRC,this._hasIHDR=!1,this._hasIEND=!1,this._emittedHeadersFinished=!1,this._palette=[],this._colorType=0,this._chunks={},this._chunks[r.TYPE_IHDR]=this._handleIHDR.bind(this),this._chunks[r.TYPE_IEND]=this._handleIEND.bind(this),this._chunks[r.TYPE_IDAT]=this._handleIDAT.bind(this),this._chunks[r.TYPE_PLTE]=this._handlePLTE.bind(this),this._chunks[r.TYPE_tRNS]=this._handleTRNS.bind(this),this._chunks[r.TYPE_gAMA]=this._handleGAMA.bind(this),this.read=e.read,this.error=e.error,this.metadata=e.metadata,this.gamma=e.gamma,this.transColor=e.transColor,this.palette=e.palette,this.parsed=e.parsed,this.inflateData=e.inflateData,this.finished=e.finished,this.simpleTransparency=e.simpleTransparency,this.headersFinished=e.headersFinished||function(){}};s.prototype.start=function(){this.read(r.PNG_SIGNATURE.length,this._parseSignature.bind(this))},s.prototype._parseSignature=function(t){let e=r.PNG_SIGNATURE;for(let i=0;i<e.length;i++)if(t[i]!==e[i])return void this.error(Error("Invalid file signature"));this.read(8,this._parseChunkBegin.bind(this))},s.prototype._parseChunkBegin=function(t){let e=t.readUInt32BE(0),i=t.readUInt32BE(4),s="";for(let e=4;e<8;e++)s+=String.fromCharCode(t[e]);let a=!!(32&t[4]);return this._hasIHDR||i===r.TYPE_IHDR?(this._crc=new n,this._crc.write(Buffer.from(s)),this._chunks[i])?this._chunks[i](e):a?void this.read(e+4,this._skipChunk.bind(this)):void this.error(Error("Unsupported critical chunk type "+s)):void this.error(Error("Expected IHDR on beggining"))},s.prototype._skipChunk=function(){this.read(8,this._parseChunkBegin.bind(this))},s.prototype._handleChunkEnd=function(){this.read(4,this._parseChunkEnd.bind(this))},s.prototype._parseChunkEnd=function(t){let e=t.readInt32BE(0),i=this._crc.crc32();this._options.checkCRC&&i!==e?this.error(Error("Crc error - "+e+" - "+i)):this._hasIEND||this.read(8,this._parseChunkBegin.bind(this))},s.prototype._handleIHDR=function(t){this.read(t,this._parseIHDR.bind(this))},s.prototype._parseIHDR=function(t){this._crc.write(t);let e=t.readUInt32BE(0),i=t.readUInt32BE(4),n=t[8],s=t[9],a=t[10],o=t[11],h=t[12];if(8!==n&&4!==n&&2!==n&&1!==n&&16!==n)return void this.error(Error("Unsupported bit depth "+n));if(!(s in r.COLORTYPE_TO_BPP_MAP))return void this.error(Error("Unsupported color type"));if(0!==a)return void this.error(Error("Unsupported compression method"));if(0!==o)return void this.error(Error("Unsupported filter method"));if(0!==h&&1!==h)return void this.error(Error("Unsupported interlace method"));this._colorType=s;let l=r.COLORTYPE_TO_BPP_MAP[this._colorType];this._hasIHDR=!0,this.metadata({width:e,height:i,depth:n,interlace:!!h,palette:!!(s&r.COLORTYPE_PALETTE),color:!!(s&r.COLORTYPE_COLOR),alpha:!!(s&r.COLORTYPE_ALPHA),bpp:l,colorType:s}),this._handleChunkEnd()},s.prototype._handlePLTE=function(t){this.read(t,this._parsePLTE.bind(this))},s.prototype._parsePLTE=function(t){this._crc.write(t);let e=Math.floor(t.length/3);for(let i=0;i<e;i++)this._palette.push([t[3*i],t[3*i+1],t[3*i+2],255]);this.palette(this._palette),this._handleChunkEnd()},s.prototype._handleTRNS=function(t){this.simpleTransparency(),this.read(t,this._parseTRNS.bind(this))},s.prototype._parseTRNS=function(t){if(this._crc.write(t),this._colorType===r.COLORTYPE_PALETTE_COLOR){if(0===this._palette.length)return void this.error(Error("Transparency chunk must be after palette"));if(t.length>this._palette.length)return void this.error(Error("More transparent colors than palette size"));for(let e=0;e<t.length;e++)this._palette[e][3]=t[e];this.palette(this._palette)}this._colorType===r.COLORTYPE_GRAYSCALE&&this.transColor([t.readUInt16BE(0)]),this._colorType===r.COLORTYPE_COLOR&&this.transColor([t.readUInt16BE(0),t.readUInt16BE(2),t.readUInt16BE(4)]),this._handleChunkEnd()},s.prototype._handleGAMA=function(t){this.read(t,this._parseGAMA.bind(this))},s.prototype._parseGAMA=function(t){this._crc.write(t),this.gamma(t.readUInt32BE(0)/r.GAMMA_DIVISION),this._handleChunkEnd()},s.prototype._handleIDAT=function(t){this._emittedHeadersFinished||(this._emittedHeadersFinished=!0,this.headersFinished()),this.read(-t,this._parseIDAT.bind(this,t))},s.prototype._parseIDAT=function(t,e){if(this._crc.write(e),this._colorType===r.COLORTYPE_PALETTE_COLOR&&0===this._palette.length)throw Error("Expected palette not found");this.inflateData(e);let i=t-e.length;i>0?this._handleIDAT(i):this._handleChunkEnd()},s.prototype._handleIEND=function(t){this.read(t,this._parseIEND.bind(this))},s.prototype._parseIEND=function(t){this._crc.write(t),this._hasIEND=!0,this._handleChunkEnd(),this.finished&&this.finished()}},65551,(t,e,i)=>{"use strict";let r=t.r(3469),n=[function(){},function(t,e,i,r){if(r===e.length)throw Error("Ran out of data");let n=e[r];t[i]=n,t[i+1]=n,t[i+2]=n,t[i+3]=255},function(t,e,i,r){if(r+1>=e.length)throw Error("Ran out of data");let n=e[r];t[i]=n,t[i+1]=n,t[i+2]=n,t[i+3]=e[r+1]},function(t,e,i,r){if(r+2>=e.length)throw Error("Ran out of data");t[i]=e[r],t[i+1]=e[r+1],t[i+2]=e[r+2],t[i+3]=255},function(t,e,i,r){if(r+3>=e.length)throw Error("Ran out of data");t[i]=e[r],t[i+1]=e[r+1],t[i+2]=e[r+2],t[i+3]=e[r+3]}],s=[function(){},function(t,e,i,r){let n=e[0];t[i]=n,t[i+1]=n,t[i+2]=n,t[i+3]=r},function(t,e,i){let r=e[0];t[i]=r,t[i+1]=r,t[i+2]=r,t[i+3]=e[1]},function(t,e,i,r){t[i]=e[0],t[i+1]=e[1],t[i+2]=e[2],t[i+3]=r},function(t,e,i){t[i]=e[0],t[i+1]=e[1],t[i+2]=e[2],t[i+3]=e[3]}];i.dataToBitMap=function(t,e){let i,a,o,h,l,p,u=e.width,f=e.height,c=e.depth,d=e.bpp,_=e.interlace;8!==c&&(i=[],a=0,o={get:function(e){for(;i.length<e;)!function(){let e,r,n,s;if(a===t.length)throw Error("Ran out of data");let o=t[a];switch(a++,c){default:throw Error("unrecognised depth");case 16:n=t[a],a++,i.push((o<<8)+n);break;case 4:n=15&o,s=o>>4,i.push(s,n);break;case 2:e=3&o,r=o>>2&3,n=o>>4&3,s=o>>6&3,i.push(s,n,r,e);break;case 1:e=o>>4&1,r=o>>5&1,n=o>>6&1,s=o>>7&1,i.push(s,n,r,e,o>>3&1,o>>2&1,o>>1&1,1&o)}}();let r=i.slice(0,e);return i=i.slice(e),r},resetAfterLine:function(){i.length=0},end:function(){if(a!==t.length)throw Error("extra data found")}}),h=c<=8?Buffer.alloc(u*f*4):new Uint16Array(u*f*4);let g=Math.pow(2,c)-1,y=0;if(_)l=r.getImagePasses(u,f),p=r.getInterlaceIterator(u,f);else{let t=0;p=function(){let e=t;return t+=4,e},l=[{width:u,height:f}]}for(let e=0;e<l.length;e++)8===c?y=function(t,e,i,r,s,a){let o=t.width,h=t.height,l=t.index;for(let t=0;t<h;t++)for(let h=0;h<o;h++){let o=i(h,t,l);n[r](e,s,o,a),a+=r}return a}(l[e],h,p,d,t,y):function(t,e,i,r,n,a){let o=t.width,h=t.height,l=t.index;for(let t=0;t<h;t++){for(let h=0;h<o;h++){let o=n.get(r),p=i(h,t,l);s[r](e,o,p,a)}n.resetAfterLine()}}(l[e],h,p,d,o,g);if(8===c){if(y!==t.length)throw Error("extra data found")}else o.end();return h}},76240,(t,e,i)=>{"use strict";e.exports=function(t,e,i=!1){let r=e.depth,n=e.width,s=e.height,a=e.colorType,o=e.transColor,h=e.palette,l=t;return 3===a?!function(t,e,i,r,n){let s=0;for(let a=0;a<r;a++)for(let r=0;r<i;r++){let i=n[t[s]];if(!i)throw Error("index "+t[s]+" not in palette");for(let t=0;t<4;t++)e[s+t]=i[t];s+=4}}(t,l,n,s,h):(o&&function(t,e,i,r,n){let s=0;for(let a=0;a<r;a++)for(let r=0;r<i;r++){let i=!1;if(1===n.length?n[0]===t[s]&&(i=!0):n[0]===t[s]&&n[1]===t[s+1]&&n[2]===t[s+2]&&(i=!0),i)for(let t=0;t<4;t++)e[s+t]=0;s+=4}}(t,l,n,s,o),8===r||i||(16===r&&(l=Buffer.alloc(n*s*4)),!function(t,e,i,r,n){let s=Math.pow(2,n)-1,a=0;for(let n=0;n<r;n++)for(let r=0;r<i;r++){for(let i=0;i<4;i++)e[a+i]=Math.floor(255*t[a+i]/s+.5);a+=4}}(t,l,n,s,r))),l}},29937,(t,e,i)=>{"use strict";let r=t.r(24361),n=t.r(6461),s=t.r(32921),a=t.r(44502),o=t.r(89955),h=t.r(65551),l=t.r(76240),p=e.exports=function(t){s.call(this),this._parser=new o(t,{read:this.read.bind(this),error:this._handleError.bind(this),metadata:this._handleMetaData.bind(this),gamma:this.emit.bind(this,"gamma"),palette:this._handlePalette.bind(this),transColor:this._handleTransColor.bind(this),finished:this._finished.bind(this),inflateData:this._inflateData.bind(this),simpleTransparency:this._simpleTransparency.bind(this),headersFinished:this._headersFinished.bind(this)}),this._options=t,this.writable=!0,this._parser.start()};r.inherits(p,s),p.prototype._handleError=function(t){this.emit("error",t),this.writable=!1,this.destroy(),this._inflate&&this._inflate.destroy&&this._inflate.destroy(),this._filter&&(this._filter.destroy(),this._filter.on("error",function(){})),this.errord=!0},p.prototype._inflateData=function(t){if(!this._inflate)if(this._bitmapInfo.interlace)this._inflate=n.createInflate(),this._inflate.on("error",this.emit.bind(this,"error")),this._filter.on("complete",this._complete.bind(this)),this._inflate.pipe(this._filter);else{let t=((this._bitmapInfo.width*this._bitmapInfo.bpp*this._bitmapInfo.depth+7>>3)+1)*this._bitmapInfo.height,e=Math.max(t,n.Z_MIN_CHUNK);this._inflate=n.createInflate({chunkSize:e});let i=t,r=this.emit.bind(this,"error");this._inflate.on("error",function(t){i&&r(t)}),this._filter.on("complete",this._complete.bind(this));let s=this._filter.write.bind(this._filter);this._inflate.on("data",function(t){i&&(t.length>i&&(t=t.slice(0,i)),i-=t.length,s(t))}),this._inflate.on("end",this._filter.end.bind(this._filter))}this._inflate.write(t)},p.prototype._handleMetaData=function(t){this._metaData=t,this._bitmapInfo=Object.create(t),this._filter=new a(this._bitmapInfo)},p.prototype._handleTransColor=function(t){this._bitmapInfo.transColor=t},p.prototype._handlePalette=function(t){this._bitmapInfo.palette=t},p.prototype._simpleTransparency=function(){this._metaData.alpha=!0},p.prototype._headersFinished=function(){this.emit("metadata",this._metaData)},p.prototype._finished=function(){this.errord||(this._inflate?this._inflate.end():this.emit("error","No Inflate block"))},p.prototype._complete=function(t){let e;if(!this.errord){try{let i=h.dataToBitMap(t,this._bitmapInfo);e=l(i,this._bitmapInfo,this._options.skipRescale),i=null}catch(t){this._handleError(t);return}this.emit("parsed",e)}}},2243,(t,e,i)=>{"use strict";let r=t.r(58461);e.exports=function(t,e,i,n){let s=-1!==[r.COLORTYPE_COLOR_ALPHA,r.COLORTYPE_ALPHA].indexOf(n.colorType);if(n.colorType===n.inputColorType){let e,i=(new DataView(e=new ArrayBuffer(2)).setInt16(0,256,!0),256!==new Int16Array(e)[0]);if(8===n.bitDepth||16===n.bitDepth&&i)return t}let a=16!==n.bitDepth?t:new Uint16Array(t.buffer),o=255,h=r.COLORTYPE_TO_BPP_MAP[n.inputColorType];4!==h||n.inputHasAlpha||(h=3);let l=r.COLORTYPE_TO_BPP_MAP[n.colorType];16===n.bitDepth&&(o=65535,l*=2);let p=Buffer.alloc(e*i*l),u=0,f=0,c=n.bgColor||{};void 0===c.red&&(c.red=o),void 0===c.green&&(c.green=o),void 0===c.blue&&(c.blue=o);for(let t=0;t<i;t++)for(let t=0;t<e;t++){let t=function(){let t,e,i,h=o;switch(n.inputColorType){case r.COLORTYPE_COLOR_ALPHA:h=a[u+3],t=a[u],e=a[u+1],i=a[u+2];break;case r.COLORTYPE_COLOR:t=a[u],e=a[u+1],i=a[u+2];break;case r.COLORTYPE_ALPHA:h=a[u+1],e=t=a[u],i=t;break;case r.COLORTYPE_GRAYSCALE:e=t=a[u],i=t;break;default:throw Error("input color type:"+n.inputColorType+" is not supported at present")}return n.inputHasAlpha&&!s&&(h/=o,t=Math.min(Math.max(Math.round((1-h)*c.red+h*t),0),o),e=Math.min(Math.max(Math.round((1-h)*c.green+h*e),0),o),i=Math.min(Math.max(Math.round((1-h)*c.blue+h*i),0),o)),{red:t,green:e,blue:i,alpha:h}}(a,u);switch(n.colorType){case r.COLORTYPE_COLOR_ALPHA:case r.COLORTYPE_COLOR:8===n.bitDepth?(p[f]=t.red,p[f+1]=t.green,p[f+2]=t.blue,s&&(p[f+3]=t.alpha)):(p.writeUInt16BE(t.red,f),p.writeUInt16BE(t.green,f+2),p.writeUInt16BE(t.blue,f+4),s&&p.writeUInt16BE(t.alpha,f+6));break;case r.COLORTYPE_ALPHA:case r.COLORTYPE_GRAYSCALE:{let e=(t.red+t.green+t.blue)/3;8===n.bitDepth?(p[f]=e,s&&(p[f+1]=t.alpha)):(p.writeUInt16BE(e,f),s&&p.writeUInt16BE(t.alpha,f+2));break}default:throw Error("unrecognised color Type "+n.colorType)}u+=h,f+=l}return p}},21115,(t,e,i)=>{"use strict";let r=t.r(39548),n={0:function(t,e,i,r,n){for(let s=0;s<i;s++)r[n+s]=t[e+s]},1:function(t,e,i,r,n,s){for(let a=0;a<i;a++){let i=a>=s?t[e+a-s]:0,o=t[e+a]-i;r[n+a]=o}},2:function(t,e,i,r,n){for(let s=0;s<i;s++){let a=e>0?t[e+s-i]:0,o=t[e+s]-a;r[n+s]=o}},3:function(t,e,i,r,n,s){for(let a=0;a<i;a++){let o=a>=s?t[e+a-s]:0,h=e>0?t[e+a-i]:0,l=t[e+a]-(o+h>>1);r[n+a]=l}},4:function(t,e,i,n,s,a){for(let o=0;o<i;o++){let h=o>=a?t[e+o-a]:0,l=e>0?t[e+o-i]:0,p=e>0&&o>=a?t[e+o-(i+a)]:0,u=t[e+o]-r(h,l,p);n[s+o]=u}}},s={0:function(t,e,i){let r=0,n=e+i;for(let i=e;i<n;i++)r+=Math.abs(t[i]);return r},1:function(t,e,i,r){let n=0;for(let s=0;s<i;s++){let i=s>=r?t[e+s-r]:0;n+=Math.abs(t[e+s]-i)}return n},2:function(t,e,i){let r=0,n=e+i;for(let s=e;s<n;s++){let n=e>0?t[s-i]:0;r+=Math.abs(t[s]-n)}return r},3:function(t,e,i,r){let n=0;for(let s=0;s<i;s++){let a=s>=r?t[e+s-r]:0,o=e>0?t[e+s-i]:0;n+=Math.abs(t[e+s]-(a+o>>1))}return n},4:function(t,e,i,n){let s=0;for(let a=0;a<i;a++){let o=a>=n?t[e+a-n]:0,h=e>0?t[e+a-i]:0,l=e>0&&a>=n?t[e+a-(i+n)]:0;s+=Math.abs(t[e+a]-r(o,h,l))}return s}};e.exports=function(t,e,i,r,a){let o;if("filterType"in r&&-1!==r.filterType)if("number"==typeof r.filterType)o=[r.filterType];else throw Error("unrecognised filter types");else o=[0,1,2,3,4];16===r.bitDepth&&(a*=2);let h=e*a,l=0,p=0,u=Buffer.alloc((h+1)*i),f=o[0];for(let e=0;e<i;e++){if(o.length>1){let e=1/0;for(let i=0;i<o.length;i++){let r=s[o[i]](t,p,h,a);r<e&&(f=o[i],e=r)}}u[l]=f,l++,n[f](t,p,h,u,l,a),l+=h,p+=h}return u}},33347,(t,e,i)=>{"use strict";let r=t.r(58461),n=t.r(37754),s=t.r(2243),a=t.r(21115),o=t.r(6461),h=e.exports=function(t){if(this._options=t,t.deflateChunkSize=t.deflateChunkSize||32768,t.deflateLevel=null!=t.deflateLevel?t.deflateLevel:9,t.deflateStrategy=null!=t.deflateStrategy?t.deflateStrategy:3,t.inputHasAlpha=null==t.inputHasAlpha||t.inputHasAlpha,t.deflateFactory=t.deflateFactory||o.createDeflate,t.bitDepth=t.bitDepth||8,t.colorType="number"==typeof t.colorType?t.colorType:r.COLORTYPE_COLOR_ALPHA,t.inputColorType="number"==typeof t.inputColorType?t.inputColorType:r.COLORTYPE_COLOR_ALPHA,-1===[r.COLORTYPE_GRAYSCALE,r.COLORTYPE_COLOR,r.COLORTYPE_COLOR_ALPHA,r.COLORTYPE_ALPHA].indexOf(t.colorType))throw Error("option color type:"+t.colorType+" is not supported at present");if(-1===[r.COLORTYPE_GRAYSCALE,r.COLORTYPE_COLOR,r.COLORTYPE_COLOR_ALPHA,r.COLORTYPE_ALPHA].indexOf(t.inputColorType))throw Error("option input color type:"+t.inputColorType+" is not supported at present");if(8!==t.bitDepth&&16!==t.bitDepth)throw Error("option bit depth:"+t.bitDepth+" is not supported at present")};h.prototype.getDeflateOptions=function(){return{chunkSize:this._options.deflateChunkSize,level:this._options.deflateLevel,strategy:this._options.deflateStrategy}},h.prototype.createDeflate=function(){return this._options.deflateFactory(this.getDeflateOptions())},h.prototype.filterData=function(t,e,i){let n=s(t,e,i,this._options),o=r.COLORTYPE_TO_BPP_MAP[this._options.colorType];return a(n,e,i,this._options,o)},h.prototype._packChunk=function(t,e){let i=e?e.length:0,r=Buffer.alloc(i+12);return r.writeUInt32BE(i,0),r.writeUInt32BE(t,4),e&&e.copy(r,8),r.writeInt32BE(n.crc32(r.slice(4,r.length-4)),r.length-4),r},h.prototype.packGAMA=function(t){let e=Buffer.alloc(4);return e.writeUInt32BE(Math.floor(t*r.GAMMA_DIVISION),0),this._packChunk(r.TYPE_gAMA,e)},h.prototype.packIHDR=function(t,e){let i=Buffer.alloc(13);return i.writeUInt32BE(t,0),i.writeUInt32BE(e,4),i[8]=this._options.bitDepth,i[9]=this._options.colorType,i[10]=0,i[11]=0,i[12]=0,this._packChunk(r.TYPE_IHDR,i)},h.prototype.packIDAT=function(t){return this._packChunk(r.TYPE_IDAT,t)},h.prototype.packIEND=function(){return this._packChunk(r.TYPE_IEND,null)}},62348,(t,e,i)=>{"use strict";let r=t.r(24361),n=t.r(88947),s=t.r(58461),a=t.r(33347),o=e.exports=function(t){n.call(this),this._packer=new a(t||{}),this._deflate=this._packer.createDeflate(),this.readable=!0};r.inherits(o,n),o.prototype.pack=function(t,e,i,r){this.emit("data",Buffer.from(s.PNG_SIGNATURE)),this.emit("data",this._packer.packIHDR(e,i)),r&&this.emit("data",this._packer.packGAMA(r));let n=this._packer.filterData(t,e,i);this._deflate.on("error",this.emit.bind(this,"error")),this._deflate.on("data",(function(t){this.emit("data",this._packer.packIDAT(t))}).bind(this)),this._deflate.on("end",(function(){this.emit("data",this._packer.packIEND()),this.emit("end")}).bind(this)),this._deflate.end(n)}},49719,(t,e,i)=>{e.exports=t.x("assert",()=>require("assert"))},874,(t,e,i)=>{e.exports=t.x("buffer",()=>require("buffer"))},57843,(t,e,i)=>{"use strict";let r=t.r(49719).ok,n=t.r(6461),s=t.r(24361),a=t.r(874).kMaxLength;function o(t){if(!(this instanceof o))return new o(t);t&&t.chunkSize<n.Z_MIN_CHUNK&&(t.chunkSize=n.Z_MIN_CHUNK),n.Inflate.call(this,t),this._offset=void 0===this._offset?this._outOffset:this._offset,this._buffer=this._buffer||this._outBuffer,t&&null!=t.maxLength&&(this._maxLength=t.maxLength)}function h(t,e){e&&process.nextTick(e),t._handle&&(t._handle.close(),t._handle=null)}function l(t,e){var i=new o(e),r=t;if("string"==typeof r&&(r=Buffer.from(r)),!(r instanceof Buffer))throw TypeError("Not a string or buffer");let s=i._finishFlushFlag;return null==s&&(s=n.Z_FINISH),i._processChunk(r,s)}o.prototype._processChunk=function(t,e,i){let s,o;if("function"==typeof i)return n.Inflate._processChunk.call(this,t,e,i);let l=this,p=t&&t.length,u=this._chunkSize-this._offset,f=this._maxLength,c=0,d=[],_=0;this.on("error",function(t){s=t}),r(this._handle,"zlib binding closed");do o=(o=this._handle.writeSync(e,t,c,p,this._buffer,this._offset,u))||this._writeState;while(!this._hadError&&function(t,e){if(l._hadError)return;let i=u-e;if(r(i>=0,"have should not go down"),i>0){let t=l._buffer.slice(l._offset,l._offset+i);if(l._offset+=i,t.length>f&&(t=t.slice(0,f)),d.push(t),_+=t.length,0==(f-=t.length))return!1}return(0===e||l._offset>=l._chunkSize)&&(u=l._chunkSize,l._offset=0,l._buffer=Buffer.allocUnsafe(l._chunkSize)),0===e&&(c+=p-t,p=t,!0)}(o[0],o[1]))if(this._hadError)throw s;if(_>=a)throw h(this),RangeError("Cannot create final Buffer. It would be larger than 0x"+a.toString(16)+" bytes");let g=Buffer.concat(d,_);return h(this),g},s.inherits(o,n.Inflate),e.exports=i=l,i.Inflate=o,i.createInflate=function(t){return new o(t)},i.inflateSync=l},61505,(t,e,i)=>{"use strict";let r=e.exports=function(t){this._buffer=t,this._reads=[]};r.prototype.read=function(t,e){this._reads.push({length:Math.abs(t),allowLess:t<0,func:e})},r.prototype.process=function(){for(;this._reads.length>0&&this._buffer.length;){let t=this._reads[0];if(this._buffer.length&&(this._buffer.length>=t.length||t.allowLess)){this._reads.shift();let e=this._buffer;this._buffer=e.slice(t.length),t.func.call(this,e.slice(0,t.length))}else break}if(this._reads.length>0)throw Error("There are some read requests waitng on finished stream");if(this._buffer.length>0)throw Error("unrecognised content at end of stream")}},15269,(t,e,i)=>{"use strict";let r=t.r(61505),n=t.r(50617);i.process=function(t,e){let i=[],s=new r(t);return new n(e,{read:s.read.bind(s),write:function(t){i.push(t)},complete:function(){}}).start(),s.process(),Buffer.concat(i)}},65750,(t,e,i)=>{"use strict";let r=!0,n=t.r(6461),s=t.r(57843);n.deflateSync||(r=!1);let a=t.r(61505),o=t.r(15269),h=t.r(89955),l=t.r(65551),p=t.r(76240);e.exports=function(t,e){let i,u,f,c;if(!r)throw Error("To use the sync capability of this library in old node versions, please pin pngjs to v2.3.0");let d=[],_=new a(t);if(new h(e,{read:_.read.bind(_),error:function(t){i=t},metadata:function(t){u=t},gamma:function(t){f=t},palette:function(t){u.palette=t},transColor:function(t){u.transColor=t},inflateData:function(t){d.push(t)},simpleTransparency:function(){u.alpha=!0}}).start(),_.process(),i)throw i;let g=Buffer.concat(d);if(d.length=0,u.interlace)c=n.inflateSync(g);else{let t=((u.width*u.bpp*u.depth+7>>3)+1)*u.height;c=s(g,{chunkSize:t,maxLength:t})}if(g=null,!c||!c.length)throw Error("bad png - invalid inflate data response");let y=o.process(c,u);g=null;let b=l.dataToBitMap(y,u);y=null;let m=p(b,u,e.skipRescale);return u.data=m,u.gamma=f||0,u}},53900,(t,e,i)=>{"use strict";let r=!0,n=t.r(6461);n.deflateSync||(r=!1);let s=t.r(58461),a=t.r(33347);e.exports=function(t,e){if(!r)throw Error("To use the sync capability of this library in old node versions, please pin pngjs to v2.3.0");let i=new a(e||{}),o=[];o.push(Buffer.from(s.PNG_SIGNATURE)),o.push(i.packIHDR(t.width,t.height)),t.gamma&&o.push(i.packGAMA(t.gamma));let h=i.filterData(t.data,t.width,t.height),l=n.deflateSync(h,i.getDeflateOptions());if(h=null,!l||!l.length)throw Error("bad png - invalid compressed data response");return o.push(i.packIDAT(l)),o.push(i.packIEND()),Buffer.concat(o)}},41656,(t,e,i)=>{"use strict";let r=t.r(65750),n=t.r(53900);i.read=function(t,e){return r(t,e||{})},i.write=function(t,e){return n(t,e)}},28708,(t,e,i)=>{"use strict";let r=t.r(24361),n=t.r(88947),s=t.r(29937),a=t.r(62348),o=t.r(41656),h=i.PNG=function(t){n.call(this),t=t||{},this.width=0|t.width,this.height=0|t.height,this.data=this.width>0&&this.height>0?Buffer.alloc(4*this.width*this.height):null,t.fill&&this.data&&this.data.fill(0),this.gamma=0,this.readable=this.writable=!0,this._parser=new s(t),this._parser.on("error",this.emit.bind(this,"error")),this._parser.on("close",this._handleClose.bind(this)),this._parser.on("metadata",this._metadata.bind(this)),this._parser.on("gamma",this._gamma.bind(this)),this._parser.on("parsed",(function(t){this.data=t,this.emit("parsed",t)}).bind(this)),this._packer=new a(t),this._packer.on("data",this.emit.bind(this,"data")),this._packer.on("end",this.emit.bind(this,"end")),this._parser.on("close",this._handleClose.bind(this)),this._packer.on("error",this.emit.bind(this,"error"))};r.inherits(h,n),h.sync=o,h.prototype.pack=function(){return this.data&&this.data.length?process.nextTick((function(){this._packer.pack(this.data,this.width,this.height,this.gamma)}).bind(this)):this.emit("error","No data provided"),this},h.prototype.parse=function(t,e){if(e){let t,i;t=(function(t){this.removeListener("error",i),this.data=t,e(null,this)}).bind(this),i=(function(i){this.removeListener("parsed",t),e(i,null)}).bind(this),this.once("parsed",t),this.once("error",i)}return this.end(t),this},h.prototype.write=function(t){return this._parser.write(t),!0},h.prototype.end=function(t){this._parser.end(t)},h.prototype._metadata=function(t){this.width=t.width,this.height=t.height,this.emit("metadata",t)},h.prototype._gamma=function(t){this.gamma=t},h.prototype._handleClose=function(){this._parser.writable||this._packer.readable||this.emit("close")},h.bitblt=function(t,e,i,r,n,s,a,o){if(r|=0,n|=0,s|=0,a|=0,o|=0,(i|=0)>t.width||r>t.height||i+n>t.width||r+s>t.height)throw Error("bitblt reading outside image");if(a>e.width||o>e.height||a+n>e.width||o+s>e.height)throw Error("bitblt writing outside image");for(let h=0;h<s;h++)t.data.copy(e.data,(o+h)*e.width+a<<2,(r+h)*t.width+i<<2,(r+h)*t.width+i+n<<2)},h.prototype.bitblt=function(t,e,i,r,n,s,a){return h.bitblt(this,t,e,i,r,n,s,a),this},h.adjustGamma=function(t){if(t.gamma){for(let e=0;e<t.height;e++)for(let i=0;i<t.width;i++){let r=t.width*e+i<<2;for(let e=0;e<3;e++){let i=t.data[r+e]/255;i=Math.pow(i,1/2.2/t.gamma),t.data[r+e]=Math.round(255*i)}}t.gamma=0}},h.prototype.adjustGamma=function(){h.adjustGamma(this)}},91961,t=>{"use strict";var e=t.i(47909),i=t.i(74017),r=t.i(96250),n=t.i(59756),s=t.i(61916),a=t.i(74677),o=t.i(69741),h=t.i(16795),l=t.i(87718),p=t.i(95169),u=t.i(47587),f=t.i(66012),c=t.i(70101),d=t.i(26937),_=t.i(10372),g=t.i(93695);t.i(52474);var y=t.i(220),b=t.i(89171),m=t.i(28708);async function E(t){try{let{searchParams:e}=t.nextUrl,i=e.get("layer"),r=e.get("z"),n=e.get("x"),s=e.get("y");if(!r||!n||!s||!i)return b.NextResponse.json({error:"Missing parameters. Required: layer, z, x, y"},{status:400});let a=parseInt(r),o=parseInt(n),h=parseInt(s);if(isNaN(a)||isNaN(o)||isNaN(h))return b.NextResponse.json({error:"Invalid tile coordinates"},{status:400});if(a<0||a>18)return w();let l=Math.pow(2,a);if(o<0||o>=l||h<0||h>=l)return w();if(i.startsWith("synthetic-")){let t=parseInt(i.split("-")[1]);if(isNaN(t))return b.NextResponse.json({error:"Invalid synthetic timestamp"},{status:400});return console.log(`[Tile] Synthetic: z=${a} x=${o} y=${h} time=${t}`),await T(a,o,h,t)}return b.NextResponse.json({error:"Invalid layer format - only synthetic layers supported"},{status:400})}catch(t){return console.error("[Tile] Error:",t.message),w()}}function w(){let t=Buffer.from([137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,0,0,0,1,0,0,0,1,8,6,0,0,0,31,21,196,137,0,0,0,10,73,68,65,84,120,156,99,0,1,0,0,5,0,1,13,10,45,180,0,0,0,0,73,69,78,68,174,66,96,130]);return new b.NextResponse(t,{headers:{"Content-Type":"image/png","Cache-Control":"public, max-age=300","Access-Control-Allow-Origin":"*"}})}async function T(t,e,i,r){try{let n=Math.pow(2,t),s=e/n*360-180,a=180*Math.atan(Math.sinh(Math.PI*(1-2*i/n)))/Math.PI,o=(e+1)/n*360-180,h=180*Math.atan(Math.sinh(Math.PI*(1-2*(i+1)/n)))/Math.PI,l=[];!function(t,e,i,r,n,s){let a=t=>{let e=1e4*Math.sin(t);return e-Math.floor(e)};for(let o=0;o<3;o++){let h=s/36e5*.2,l=e+a(s+100*o)*(r-e),p=i+a(s+200*o)*(n-i),u=l+.8*Math.sin(h+o)+(a(s+300*o)-.5)*.4,f=p+.8*Math.cos(h+1.2*o)+(a(s+400*o)-.5)*.4,c=s%864e5/864e5,d=a(s+500*o),_=.3*Math.sin(c*Math.PI*2+.5*o)+.7,g=Math.max(.03,3*Math.max(.01,.08+.8*Math.sin(c*Math.PI*2+o)*Math.sin(d*Math.PI)*a(s+600*o)*_)),y=8+Math.floor(6*a(s+700*o));for(let e=0;e<y;e++){let i=(a(s+800*o+100*e)-.5)*1.5,r=(a(s+900*o+200*e)-.5)*1.5,n=g*(.2+.8*a(s+1e3*o+300*e));t.push({lat:u+i,lon:f+r,value:n})}}for(let o=3;o<12;o++){let h=s/36e5*.4,l=e+a(s+100*o)*(r-e),p=i+a(s+200*o)*(n-i),u=l+1.5*Math.sin(h+o)+(a(s+300*o)-.5)*.8,f=p+1.5*Math.cos(h+1.4*o)+(a(s+400*o)-.5)*.8,c=s%864e5/864e5,d=a(s+500*o),_=Math.max(.01,1.8*Math.max(.005,.03+.5*Math.sin(c*Math.PI*2+1.2*o)*Math.sin(d*Math.PI)*a(s+600*o))),g=4+Math.floor(3*a(s+700*o));for(let e=0;e<g;e++){let i=(a(s+800*o+100*e)-.5)*.6,r=(a(s+900*o+200*e)-.5)*.6,n=_*(.3+.7*a(s+1e3*o+300*e));t.push({lat:u+i,lon:f+r,value:n})}}}(l,a,s,h,o,r),console.log(`[Tile] Pure synthetic z=${t} x=${e} y=${i} t=${new Date(r).toISOString().slice(0,16)}: ${l.length} synthetic points`);let p=function(t,e,i,r,n,s,a,o={}){let h=o.power??2,l=o.radius??1/0,p=o.minPoints??1,u=o.nodata??NaN,f=[];for(let e=0;e<256;e++){let i=[],o=r+e/255*(s-r);for(let e=0;e<256;e++){let r=n+e/255*(a-n),s=0,f=0,d=0;for(let e of t){var c;let t=(c=e.lat,12742*Math.asin(Math.sqrt(Math.sin((c-o)*Math.PI/180/2)**2+Math.cos(o*Math.PI/180)*Math.cos(c*Math.PI/180)*Math.sin((e.lon-r)*Math.PI/180/2)**2)));if(0===t){i.push(e.value),d=-1;break}if(t<=l){let i=1/Math.pow(t,h);s+=i,f+=i*e.value,d++}}-1!==d&&(d>=p&&s>0?i.push(f/s):i.push(u))}f.push(i)}return{width:256,height:256,lat0:r,lon0:n,lat1:s,lon1:a,data:f}}(l,0,0,a,s,h,o,{power:2,radius:150}),u=function(t){let e=t[0].length,i=t.length,r=new m.PNG({width:e,height:i}),n=function(t,e){let i=t.length,r=t[0].length,n=[];for(let e=0;e<i;e++){let s=[];for(let n=0;n<r;n++){let a=0,o=0;for(let s=-2;s<=2;s++)for(let h=-2;h<=2;h++){let l=e+s,p=n+h;l>=0&&l<i&&p>=0&&p<r&&!isNaN(t[l][p])&&(a+=t[l][p],o++)}s.push(o>0?a/o:0)}n.push(s)}return n}(t,2),s=0;for(let t of n)for(let e of t)e>s&&(s=e);for(let t=0;t<i;t++)for(let i=0;i<e;i++){let a=n[t][i],[o,h,l,p]=function(t){let e=Math.min(t,1);return e<.1?[0,0,0,0]:e<.2?[173,216,230,180]:e<.3?[135,206,235,200]:e<.4?[70,130,180,220]:e<.5?[25,25,112,240]:e<.6?[0,100,0,255]:e<.7?[34,139,34,255]:e<.8?[255,215,0,255]:e<.9?[255,140,0,255]:e<.98?[220,20,60,255]:[139,0,0,255]}(s>0?Math.min(a/Math.max(s,.1),1):0),u=e*t+i<<2;r.data[u]=o,r.data[u+1]=h,r.data[u+2]=l,r.data[u+3]=p}return m.PNG.sync.write(r)}(p.data);return new b.NextResponse(new Uint8Array(u),{headers:{"Content-Type":"image/png","Cache-Control":"public, max-age=300","Access-Control-Allow-Origin":"*"}})}catch(t){return console.error("[Tile] Error generating purely synthetic tile:",t.message),w()}}t.s(["GET",()=>E,"dynamic",0,"force-dynamic"],78822);var C=t.i(78822);let R=new e.AppRouteRouteModule({definition:{kind:i.RouteKind.APP_ROUTE,page:"/api/radar/tile/route",pathname:"/api/radar/tile",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/app/api/radar/tile/route.ts",nextConfigOutput:"",userland:C}),{workAsyncStorage:I,workUnitAsyncStorage:O,serverHooks:P}=R;function A(){return(0,r.patchFetch)({workAsyncStorage:I,workUnitAsyncStorage:O})}async function x(t,e,r){R.isDev&&(0,n.addRequestMeta)(t,"devRequestTimingInternalsEnd",process.hrtime.bigint());let b="/api/radar/tile/route";b=b.replace(/\/index$/,"")||"/";let m=await R.prepare(t,e,{srcPage:b,multiZoneDraftMode:!1});if(!m)return e.statusCode=400,e.end("Bad Request"),null==r.waitUntil||r.waitUntil.call(r,Promise.resolve()),null;let{buildId:E,params:w,nextConfig:T,parsedUrl:C,isDraftMode:I,prerenderManifest:O,routerServerContext:P,isOnDemandRevalidate:A,revalidateOnlyGenerated:x,resolvedPathname:k,clientReferenceManifest:L,serverActionsManifest:M}=m,D=(0,o.normalizeAppPath)(b),v=!!(O.dynamicRoutes[D]||O.routes[k]),N=async()=>((null==P?void 0:P.render404)?await P.render404(t,e,C,!1):e.end("This page could not be found"),null);if(v&&!I){let t=!!O.routes[k],e=O.dynamicRoutes[D];if(e&&!1===e.fallback&&!t){if(T.experimental.adapterPath)return await N();throw new g.NoFallbackError}}let S=null;!v||R.isDev||I||(S="/index"===(S=k)?"/":S);let B=!0===R.isDev||!v,Y=v&&!B;M&&L&&(0,a.setManifestsSingleton)({page:b,clientReferenceManifest:L,serverActionsManifest:M});let H=t.method||"GET",U=(0,s.getTracer)(),G=U.getActiveScopeSpan(),F={params:w,prerenderManifest:O,renderOpts:{experimental:{authInterrupts:!!T.experimental.authInterrupts},cacheComponents:!!T.cacheComponents,supportsDynamicResponse:B,incrementalCache:(0,n.getRequestMeta)(t,"incrementalCache"),cacheLifeProfiles:T.cacheLife,waitUntil:r.waitUntil,onClose:t=>{e.on("close",t)},onAfterTaskError:void 0,onInstrumentationRequestError:(e,i,r,n)=>R.onRequestError(t,e,r,n,P)},sharedContext:{buildId:E}},q=new h.NodeNextRequest(t),z=new h.NodeNextResponse(e),$=l.NextRequestAdapter.fromNodeNextRequest(q,(0,l.signalFromNodeResponse)(e));try{let a=async t=>R.handle($,F).finally(()=>{if(!t)return;t.setAttributes({"http.status_code":e.statusCode,"next.rsc":!1});let i=U.getRootSpanAttributes();if(!i)return;if(i.get("next.span_type")!==p.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${i.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let r=i.get("next.route");if(r){let e=`${H} ${r}`;t.setAttributes({"next.route":r,"http.route":r,"next.span_name":e}),t.updateName(e)}else t.updateName(`${H} ${b}`)}),o=!!(0,n.getRequestMeta)(t,"minimalMode"),h=async n=>{var s,h;let l=async({previousCacheEntry:i})=>{try{if(!o&&A&&x&&!i)return e.statusCode=404,e.setHeader("x-nextjs-cache","REVALIDATED"),e.end("This page could not be found"),null;let s=await a(n);t.fetchMetrics=F.renderOpts.fetchMetrics;let h=F.renderOpts.pendingWaitUntil;h&&r.waitUntil&&(r.waitUntil(h),h=void 0);let l=F.renderOpts.collectedTags;if(!v)return await (0,f.sendResponse)(q,z,s,F.renderOpts.pendingWaitUntil),null;{let t=await s.blob(),e=(0,c.toNodeOutgoingHttpHeaders)(s.headers);l&&(e[_.NEXT_CACHE_TAGS_HEADER]=l),!e["content-type"]&&t.type&&(e["content-type"]=t.type);let i=void 0!==F.renderOpts.collectedRevalidate&&!(F.renderOpts.collectedRevalidate>=_.INFINITE_CACHE)&&F.renderOpts.collectedRevalidate,r=void 0===F.renderOpts.collectedExpire||F.renderOpts.collectedExpire>=_.INFINITE_CACHE?void 0:F.renderOpts.collectedExpire;return{value:{kind:y.CachedRouteKind.APP_ROUTE,status:s.status,body:Buffer.from(await t.arrayBuffer()),headers:e},cacheControl:{revalidate:i,expire:r}}}}catch(e){throw(null==i?void 0:i.isStale)&&await R.onRequestError(t,e,{routerKind:"App Router",routePath:b,routeType:"route",revalidateReason:(0,u.getRevalidateReason)({isStaticGeneration:Y,isOnDemandRevalidate:A})},!1,P),e}},p=await R.handleResponse({req:t,nextConfig:T,cacheKey:S,routeKind:i.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:O,isRoutePPREnabled:!1,isOnDemandRevalidate:A,revalidateOnlyGenerated:x,responseGenerator:l,waitUntil:r.waitUntil,isMinimalMode:o});if(!v)return null;if((null==p||null==(s=p.value)?void 0:s.kind)!==y.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==p||null==(h=p.value)?void 0:h.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});o||e.setHeader("x-nextjs-cache",A?"REVALIDATED":p.isMiss?"MISS":p.isStale?"STALE":"HIT"),I&&e.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let g=(0,c.fromNodeOutgoingHttpHeaders)(p.value.headers);return o&&v||g.delete(_.NEXT_CACHE_TAGS_HEADER),!p.cacheControl||e.getHeader("Cache-Control")||g.get("Cache-Control")||g.set("Cache-Control",(0,d.getCacheControlHeader)(p.cacheControl)),await (0,f.sendResponse)(q,z,new Response(p.value.body,{headers:g,status:p.value.status||200})),null};G?await h(G):await U.withPropagatedContext(t.headers,()=>U.trace(p.BaseServerSpan.handleRequest,{spanName:`${H} ${b}`,kind:s.SpanKind.SERVER,attributes:{"http.method":H,"http.target":t.url}},h))}catch(e){if(e instanceof g.NoFallbackError||await R.onRequestError(t,e,{routerKind:"App Router",routePath:D,routeType:"route",revalidateReason:(0,u.getRevalidateReason)({isStaticGeneration:Y,isOnDemandRevalidate:A})},!1,P),v)throw e;return await (0,f.sendResponse)(q,z,new Response(null,{status:500})),null}}t.s(["handler",()=>x,"patchFetch",()=>A,"routeModule",()=>R,"serverHooks",()=>P,"workAsyncStorage",()=>I,"workUnitAsyncStorage",()=>O],91961)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__66ef477c._.js.map