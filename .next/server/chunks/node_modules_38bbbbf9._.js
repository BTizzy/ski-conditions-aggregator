module.exports=[1617,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.loop=r.conditional=r.parse=void 0,r.parse=function e(t,r){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:a;if(Array.isArray(r))r.forEach(function(r){return e(t,r,a,n)});else if("function"==typeof r)r(t,a,n,e);else{var i=Object.keys(r)[0];Array.isArray(r[i])?(n[i]={},e(t,r[i],a,n[i])):n[i]=r[i](t,a,n,e)}return a},r.conditional=function(e,t){return function(r,a,n,i){t(r,a,n)&&i(r,e,a,n)}},r.loop=function(e,t){return function(r,a,n,i){for(var o=[],s=r.pos;t(r,a,n);){var d={};if(i(r,e,a,d),r.pos===s)break;s=r.pos,o.push(d)}return o}}},80374,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.readBits=r.readArray=r.readUnsigned=r.readString=r.peekBytes=r.readBytes=r.peekByte=r.readByte=r.buildStream=void 0,r.buildStream=function(e){return{data:e,pos:0}};var a=function(){return function(e){return e.data[e.pos++]}};r.readByte=a,r.peekByte=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return function(t){return t.data[t.pos+e]}};var n=function(e){return function(t){return t.data.subarray(t.pos,t.pos+=e)}};r.readBytes=n,r.peekBytes=function(e){return function(t){return t.data.subarray(t.pos,t.pos+e)}},r.readString=function(e){return function(t){return Array.from(n(e)(t)).map(function(e){return String.fromCharCode(e)}).join("")}},r.readUnsigned=function(e){return function(t){var r=n(2)(t);return e?(r[1]<<8)+r[0]:(r[0]<<8)+r[1]}},r.readArray=function(e,t){return function(r,a,i){for(var o="function"==typeof t?t(r,a,i):t,s=n(e),d=Array(o),l=0;l<o;l++)d[l]=s(r);return d}};var i=function(e,t,r){for(var a=0,n=0;n<r;n++)a+=e[t+n]&&Math.pow(2,r-n-1);return a};r.readBits=function(e){return function(t){for(var r=a()(t),n=Array(8),o=0;o<8;o++)n[7-o]=!!(r&1<<o);return Object.keys(e).reduce(function(t,r){var a=e[r];return a.length?t[r]=i(n,a.index,a.length):t[r]=n[a.index],t},{})}}},31202,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var a=e.r(1617),n=e.r(80374),i={blocks:function(e){for(var t=[],r=e.data.length,a=0,i=(0,n.readByte)()(e);0!==i&&i;i=(0,n.readByte)()(e)){if(e.pos+i>=r){var o=r-e.pos;t.push((0,n.readBytes)(o)(e)),a+=o;break}t.push((0,n.readBytes)(i)(e)),a+=i}for(var s=new Uint8Array(a),d=0,l=0;l<t.length;l++)s.set(t[l],d),d+=t[l].length;return s}},o=(0,a.conditional)({gce:[{codes:(0,n.readBytes)(2)},{byteSize:(0,n.readByte)()},{extras:(0,n.readBits)({future:{index:0,length:3},disposal:{index:3,length:3},userInput:{index:6},transparentColorGiven:{index:7}})},{delay:(0,n.readUnsigned)(!0)},{transparentColorIndex:(0,n.readByte)()},{terminator:(0,n.readByte)()}]},function(e){var t=(0,n.peekBytes)(2)(e);return 33===t[0]&&249===t[1]}),s=(0,a.conditional)({image:[{code:(0,n.readByte)()},{descriptor:[{left:(0,n.readUnsigned)(!0)},{top:(0,n.readUnsigned)(!0)},{width:(0,n.readUnsigned)(!0)},{height:(0,n.readUnsigned)(!0)},{lct:(0,n.readBits)({exists:{index:0},interlaced:{index:1},sort:{index:2},future:{index:3,length:2},size:{index:5,length:3}})}]},(0,a.conditional)({lct:(0,n.readArray)(3,function(e,t,r){return Math.pow(2,r.descriptor.lct.size+1)})},function(e,t,r){return r.descriptor.lct.exists}),{data:[{minCodeSize:(0,n.readByte)()},i]}]},function(e){return 44===(0,n.peekByte)()(e)}),d=(0,a.conditional)({text:[{codes:(0,n.readBytes)(2)},{blockSize:(0,n.readByte)()},{preData:function(e,t,r){return(0,n.readBytes)(r.text.blockSize)(e)}},i]},function(e){var t=(0,n.peekBytes)(2)(e);return 33===t[0]&&1===t[1]}),l=(0,a.conditional)({application:[{codes:(0,n.readBytes)(2)},{blockSize:(0,n.readByte)()},{id:function(e,t,r){return(0,n.readString)(r.blockSize)(e)}},i]},function(e){var t=(0,n.peekBytes)(2)(e);return 33===t[0]&&255===t[1]}),c=(0,a.conditional)({comment:[{codes:(0,n.readBytes)(2)},i]},function(e){var t=(0,n.peekBytes)(2)(e);return 33===t[0]&&254===t[1]});r.default=[{header:[{signature:(0,n.readString)(3)},{version:(0,n.readString)(3)}]},{lsd:[{width:(0,n.readUnsigned)(!0)},{height:(0,n.readUnsigned)(!0)},{gct:(0,n.readBits)({exists:{index:0},resolution:{index:1,length:3},sort:{index:4},size:{index:5,length:3}})},{backgroundColorIndex:(0,n.readByte)()},{pixelAspectRatio:(0,n.readByte)()}]},(0,a.conditional)({gct:(0,n.readArray)(3,function(e,t){return Math.pow(2,t.lsd.gct.size+1)})},function(e,t){return t.lsd.gct.exists}),{frames:(0,a.loop)([o,l,c,s,d],function(e){var t=(0,n.peekByte)()(e);return 33===t||44===t})}]},98911,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.deinterlace=void 0,r.deinterlace=function(e,t){for(var r=Array(e.length),a=e.length/t,n=[0,4,2,1],i=[8,8,4,2],o=0,s=0;s<4;s++)for(var d=n[s];d<a;d+=i[s])!function(a,n){var i=e.slice(n*t,(n+1)*t);r.splice.apply(r,[a*t,t].concat(i))}(d,o),o++;return r}},40466,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.lzw=void 0,r.lzw=function(e,t,r){var a,n,i,o,s,d,l,c,u,p,f,h,g,m,y,v=Array(r),A=Array(4096),x=Array(4096),w=Array(4097);for(c=0,s=(n=1<<e)+1,a=n+2,l=-1,i=(1<<(o=e+1))-1;c<n;c++)A[c]=0,x[c]=c;for(u=0,p=f=h=g=m=y=0;u<r;){if(0===g){if(f<o){p+=t[y]<<f,f+=8,y++;continue}if(c=p&i,p>>=o,f-=o,c>a||c==s)break;if(c==n){i=(1<<(o=e+1))-1,a=n+2,l=-1;continue}if(-1==l){w[g++]=x[c],l=c,h=c;continue}for(d=c,c==a&&(w[g++]=h,c=l);c>n;)w[g++]=x[c],c=A[c];h=255&x[c],w[g++]=h,a<4096&&(A[a]=l,x[a]=h,(++a&i)==0&&a<4096&&(o++,i+=a)),l=d}g--,v[m++]=w[g],u++}for(u=m;u<r;u++)v[u]=0;return v}},11497,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.decompressFrames=r.decompressFrame=r.parseGIF=void 0;var a,n=(a=e.r(31202))&&a.__esModule?a:{default:a},i=e.r(1617),o=e.r(80374),s=e.r(98911),d=e.r(40466);r.parseGIF=function(e){var t=new Uint8Array(e);return(0,i.parse)((0,o.buildStream)(t),n.default)};var l=function(e){for(var t=e.pixels.length,r=new Uint8ClampedArray(4*t),a=0;a<t;a++){var n=4*a,i=e.pixels[a],o=e.colorTable[i]||[0,0,0];r[n]=o[0],r[n+1]=o[1],r[n+2]=o[2],r[n+3]=255*(i!==e.transparentIndex)}return r},c=function(e,t,r){if(!e.image)return void console.warn("gif frame does not have associated image.");var a=e.image,n=a.descriptor.width*a.descriptor.height,i=(0,d.lzw)(a.data.minCodeSize,a.data.blocks,n);a.descriptor.lct.interlaced&&(i=(0,s.deinterlace)(i,a.descriptor.width));var o={pixels:i,dims:{top:e.image.descriptor.top,left:e.image.descriptor.left,width:e.image.descriptor.width,height:e.image.descriptor.height}};return a.descriptor.lct&&a.descriptor.lct.exists?o.colorTable=a.lct:o.colorTable=t,e.gce&&(o.delay=10*(e.gce.delay||10),o.disposalType=e.gce.extras.disposal,e.gce.extras.transparentColorGiven&&(o.transparentIndex=e.gce.transparentColorIndex)),r&&(o.patch=l(o)),o};r.decompressFrame=c,r.decompressFrames=function(e,t){return e.frames.filter(function(e){return e.image}).map(function(r){return c(r,e.gct,t)})}},21290,e=>{"use strict";var t=e.i(47909),r=e.i(74017),a=e.i(96250),n=e.i(59756),i=e.i(61916),o=e.i(74677),s=e.i(19163),d=e.i(16795),l=e.i(87718),c=e.i(95169),u=e.i(47587),p=e.i(66012),f=e.i(70101),h=e.i(26937),g=e.i(10372),m=e.i(93695);e.i(52474);var y=e.i(220),v=e.i(89171),A=e.i(11497),x=e.i(34071),w=e.i(22734),R=e.i(14747);async function b(e){try{console.log("[NOAA Scraper] Starting NOAA radar scrape...");let e="https://radar.weather.gov/ridge/standard/NORTHEAST_loop.gif";console.log(`[NOAA Scraper] Downloading from ${e}...`);let t=await fetch(e,{headers:{"User-Agent":"Mozilla/5.0 (compatible; SkiConditionsAggregator/1.0)"},signal:AbortSignal.timeout(3e4)});if(!t.ok)throw Error(`Failed to download GIF: ${t.status} ${t.statusText}`);let r=await t.arrayBuffer();console.log(`[NOAA Scraper] Downloaded ${r.byteLength} bytes`);let a=(0,A.parseGIF)(r),n=(0,A.decompressFrames)(a,!0);console.log(`[NOAA Scraper] Parsed ${n.length} frames from GIF`);let i=[],o=R.join(process.cwd(),"cache","noaa-radar");w.existsSync(o)||w.mkdirSync(o,{recursive:!0});for(let e=0;e<n.length;e++){let t=n[e],r=Date.now()+6e5*e;console.log(`[NOAA Scraper] Processing frame ${e+1}/${n.length}...`);let a=(0,x.createCanvas)(t.dims.width,t.dims.height),s=a.getContext("2d"),d=s.createImageData(t.dims.width,t.dims.height);d.data.set(t.pixels),s.putImageData(d,0,0);let l=`noaa-frame-${r}.png`,c=R.join(o,l),u=a.toBuffer("image/png");w.writeFileSync(c,u),i.push({timestamp:r,framePath:c,frameIndex:e,width:t.dims.width,height:t.dims.height})}console.log(`[NOAA Scraper] Processed ${i.length} frames`);let s={success:!0,frames:i.map(e=>({time:Math.floor(e.timestamp/1e3),url:`noaa-${e.timestamp}`,frameIndex:e.frameIndex,dimensions:{width:e.width,height:e.height}})),metadata:{source:"NOAA Weather.gov",url:e,totalFrames:i.length,cacheLocation:o,processedAt:new Date().toISOString()}};return console.log(`[NOAA Scraper] Complete! Returning ${s.frames.length} frame metadata`),v.NextResponse.json(s)}catch(e){return console.error("[NOAA Scraper] Error:",e.message),v.NextResponse.json({error:"Failed to scrape NOAA radar",details:e.message},{status:500})}}e.s(["GET",()=>b,"dynamic",0,"force-dynamic"],4561);var S=e.i(4561);let C=new t.AppRouteRouteModule({definition:{kind:r.RouteKind.APP_ROUTE,page:"/api/radar/noaa-scrape/route",pathname:"/api/radar/noaa-scrape",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/app/api/radar/noaa-scrape/route.ts",nextConfigOutput:"",userland:S}),{workAsyncStorage:E,workUnitAsyncStorage:B,serverHooks:O}=C;function k(){return(0,a.patchFetch)({workAsyncStorage:E,workUnitAsyncStorage:B})}async function N(e,t,a){C.isDev&&(0,n.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let v="/api/radar/noaa-scrape/route";v=v.replace(/\/index$/,"")||"/";let A=await C.prepare(e,t,{srcPage:v,multiZoneDraftMode:!1});if(!A)return t.statusCode=400,t.end("Bad Request"),null==a.waitUntil||a.waitUntil.call(a,Promise.resolve()),null;let{buildId:x,params:w,nextConfig:R,parsedUrl:b,isDraftMode:S,prerenderManifest:E,routerServerContext:B,isOnDemandRevalidate:O,revalidateOnlyGenerated:k,resolvedPathname:N,clientReferenceManifest:_,serverActionsManifest:I}=A,P=(0,s.normalizeAppPath)(v),T=!!(E.dynamicRoutes[P]||E.routes[N]),U=async()=>((null==B?void 0:B.render404)?await B.render404(e,t,b,!1):t.end("This page could not be found"),null);if(T&&!S){let e=!!E.routes[N],t=E.dynamicRoutes[P];if(t&&!1===t.fallback&&!e){if(R.experimental.adapterPath)return await U();throw new m.NoFallbackError}}let M=null;!T||C.isDev||S||(M="/index"===(M=N)?"/":M);let F=!0===C.isDev||!T,j=T&&!F;I&&_&&(0,o.setManifestsSingleton)({page:v,clientReferenceManifest:_,serverActionsManifest:I});let D=e.method||"GET",$=(0,i.getTracer)(),H=$.getActiveScopeSpan(),z={params:w,prerenderManifest:E,renderOpts:{experimental:{authInterrupts:!!R.experimental.authInterrupts},cacheComponents:!!R.cacheComponents,supportsDynamicResponse:F,incrementalCache:(0,n.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:R.cacheLife,waitUntil:a.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,r,a,n)=>C.onRequestError(e,t,a,n,B)},sharedContext:{buildId:x}},q=new d.NodeNextRequest(e),G=new d.NodeNextResponse(t),K=l.NextRequestAdapter.fromNodeNextRequest(q,(0,l.signalFromNodeResponse)(t));try{let o=async e=>C.handle(K,z).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let r=$.getRootSpanAttributes();if(!r)return;if(r.get("next.span_type")!==c.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${r.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let a=r.get("next.route");if(a){let t=`${D} ${a}`;e.setAttributes({"next.route":a,"http.route":a,"next.span_name":t}),e.updateName(t)}else e.updateName(`${D} ${v}`)}),s=!!(0,n.getRequestMeta)(e,"minimalMode"),d=async n=>{var i,d;let l=async({previousCacheEntry:r})=>{try{if(!s&&O&&k&&!r)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let i=await o(n);e.fetchMetrics=z.renderOpts.fetchMetrics;let d=z.renderOpts.pendingWaitUntil;d&&a.waitUntil&&(a.waitUntil(d),d=void 0);let l=z.renderOpts.collectedTags;if(!T)return await (0,p.sendResponse)(q,G,i,z.renderOpts.pendingWaitUntil),null;{let e=await i.blob(),t=(0,f.toNodeOutgoingHttpHeaders)(i.headers);l&&(t[g.NEXT_CACHE_TAGS_HEADER]=l),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let r=void 0!==z.renderOpts.collectedRevalidate&&!(z.renderOpts.collectedRevalidate>=g.INFINITE_CACHE)&&z.renderOpts.collectedRevalidate,a=void 0===z.renderOpts.collectedExpire||z.renderOpts.collectedExpire>=g.INFINITE_CACHE?void 0:z.renderOpts.collectedExpire;return{value:{kind:y.CachedRouteKind.APP_ROUTE,status:i.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:r,expire:a}}}}catch(t){throw(null==r?void 0:r.isStale)&&await C.onRequestError(e,t,{routerKind:"App Router",routePath:v,routeType:"route",revalidateReason:(0,u.getRevalidateReason)({isStaticGeneration:j,isOnDemandRevalidate:O})},!1,B),t}},c=await C.handleResponse({req:e,nextConfig:R,cacheKey:M,routeKind:r.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:E,isRoutePPREnabled:!1,isOnDemandRevalidate:O,revalidateOnlyGenerated:k,responseGenerator:l,waitUntil:a.waitUntil,isMinimalMode:s});if(!T)return null;if((null==c||null==(i=c.value)?void 0:i.kind)!==y.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==c||null==(d=c.value)?void 0:d.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});s||t.setHeader("x-nextjs-cache",O?"REVALIDATED":c.isMiss?"MISS":c.isStale?"STALE":"HIT"),S&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let m=(0,f.fromNodeOutgoingHttpHeaders)(c.value.headers);return s&&T||m.delete(g.NEXT_CACHE_TAGS_HEADER),!c.cacheControl||t.getHeader("Cache-Control")||m.get("Cache-Control")||m.set("Cache-Control",(0,h.getCacheControlHeader)(c.cacheControl)),await (0,p.sendResponse)(q,G,new Response(c.value.body,{headers:m,status:c.value.status||200})),null};H?await d(H):await $.withPropagatedContext(e.headers,()=>$.trace(c.BaseServerSpan.handleRequest,{spanName:`${D} ${v}`,kind:i.SpanKind.SERVER,attributes:{"http.method":D,"http.target":e.url}},d))}catch(t){if(t instanceof m.NoFallbackError||await C.onRequestError(e,t,{routerKind:"App Router",routePath:P,routeType:"route",revalidateReason:(0,u.getRevalidateReason)({isStaticGeneration:j,isOnDemandRevalidate:O})},!1,B),T)throw t;return await (0,p.sendResponse)(q,G,new Response(null,{status:500})),null}}e.s(["handler",()=>N,"patchFetch",()=>k,"routeModule",()=>C,"serverHooks",()=>O,"workAsyncStorage",()=>E,"workUnitAsyncStorage",()=>B],21290)}];

//# sourceMappingURL=node_modules_38bbbbf9._.js.map