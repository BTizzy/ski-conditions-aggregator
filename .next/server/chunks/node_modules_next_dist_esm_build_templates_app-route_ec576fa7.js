module.exports=[93366,e=>{"use strict";var t=e.i(47909),n=e.i(74017),a=e.i(96250),o=e.i(59756),i=e.i(61916),r=e.i(74677),s=e.i(69741),l=e.i(16795),u=e.i(87718),p=e.i(95169),c=e.i(47587),d=e.i(66012),m=e.i(70101),w=e.i(26937),h=e.i(10372),f=e.i(93695);e.i(52474);var g=e.i(220),v=e.i(89171);let b=[{id:"loon-mountain",name:"Loon Mountain",state:"NH",lat:44.0367,lon:-71.6217,scrapeUrl:"https://www.loonmtn.com/mountain-info/conditions"},{id:"sunday-river",name:"Sunday River",state:"ME",lat:44.4722,lon:-70.8567,scrapeUrl:"https://www.sundayriver.com/mountain-info/conditions"},{id:"sugarloaf",name:"Sugarloaf",state:"ME",lat:45.0311,lon:-70.3133,scrapeUrl:"https://www.sugarloaf.com/conditions"},{id:"stowe",name:"Stowe",state:"VT",lat:44.4654,lon:-72.6874,scrapeUrl:"https://www.stowe.com/the-mountain/mountain-conditions/"},{id:"killington",name:"Killington",state:"VT",lat:43.6045,lon:-72.8201,scrapeUrl:"https://www.killington.com/the-mountain/mountain-conditions"},{id:"sugarbush",name:"Sugarbush",state:"VT",lat:44.1436,lon:-72.8944,scrapeUrl:"https://www.sugarbush.com/mountain-info/conditions/"},{id:"okemo",name:"Okemo",state:"VT",lat:43.4036,lon:-72.7202,scrapeUrl:"https://www.okemo.com/the-mountain/mountain-conditions/"},{id:"mount-snow",name:"Mount Snow",state:"VT",lat:42.9606,lon:-72.9205,scrapeUrl:"https://www.mountsnow.com/the-mountain/mountain-conditions/"},{id:"stratton",name:"Stratton",state:"VT",lat:43.1135,lon:-72.9205,scrapeUrl:"https://www.stratton.com/the-mountain/mountain-conditions"},{id:"jay-peak",name:"Jay Peak",state:"VT",lat:44.9242,lon:-72.5316,scrapeUrl:"https://jaypeakresort.com/ski-ride/conditions"},{id:"smugglers-notch",name:"Smugglers' Notch",state:"VT",lat:44.5884,lon:-72.7815,scrapeUrl:"https://www.smuggs.com/pages/winter/skiride/conditions.php"},{id:"bromley",name:"Bromley",state:"VT",lat:43.2137,lon:-72.9362,scrapeUrl:"https://www.bromley.com/the-mountain/conditions/"},{id:"mad-river-glen",name:"Mad River Glen",state:"VT",lat:44.2019,lon:-72.9172,scrapeUrl:"https://www.madriverglen.com/mountain-info/conditions"},{id:"bretton-woods",name:"Bretton Woods",state:"NH",lat:44.2547,lon:-71.4417,scrapeUrl:"https://www.brettonwoods.com/mountain-info/conditions"},{id:"cannon-mountain",name:"Cannon Mountain",state:"NH",lat:44.1786,lon:-71.6981,scrapeUrl:"https://www.cannonmt.com/mountain-info/conditions"},{id:"waterville-valley",name:"Waterville Valley",state:"NH",lat:43.9506,lon:-71.5072,scrapeUrl:"https://www.waterville.com/mountain-report"},{id:"wildcat",name:"Wildcat",state:"NH",lat:44.2581,lon:-71.2256,scrapeUrl:"https://www.skiwildcat.com/the-mountain/mountain-conditions"},{id:"attitash",name:"Attitash",state:"NH",lat:44.0822,lon:-71.2292,scrapeUrl:"https://www.attitash.com/the-mountain/mountain-conditions"},{id:"cranmore",name:"Cranmore",state:"NH",lat:44.0584,lon:-71.1284,scrapeUrl:"https://www.cranmore.com/conditions"},{id:"pats-peak",name:"Pats Peak",state:"NH",lat:43.074,lon:-71.7508,baseElevationFt:620,summitElevationFt:1030,scrapeUrl:"https://www.patspeak.com",conditionsUrl:"https://www.patspeak.com/conditions"},{id:"mount-sunapee",name:"Mount Sunapee",state:"NH",lat:43.3337,lon:-72.0586,baseElevationFt:1600,summitElevationFt:2743,scrapeUrl:"https://www.mountsunapee.com",conditionsUrl:"https://www.mountsunapee.com/mountain/conditions"},{id:"gunstock",name:"Gunstock",state:"NH",lat:43.5792,lon:-71.4246,baseElevationFt:600,summitElevationFt:2240,scrapeUrl:"https://www.gunstock.com",conditionsUrl:"https://www.gunstock.com/mountain-report"},{id:"crotched-mountain",name:"Crotched Mountain",state:"NH",lat:42.8537,lon:-71.6146,baseElevationFt:400,summitElevationFt:2066,scrapeUrl:"https://www.crotchedmountain.org",conditionsUrl:"https://www.crotchedmountain.org/mountain-report"},{id:"mcintyre",name:"McIntyre Ski Area",state:"NH",lat:42.9955,lon:-71.4601,baseElevationFt:200,summitElevationFt:350,scrapeUrl:"https://www.mcintyreskiarea.com",conditionsUrl:"https://www.mcintyreskiarea.com/conditions"},{id:"ragged-mountain",name:"Ragged Mountain",state:"NH",lat:43.2986,lon:-71.8514,baseElevationFt:600,summitElevationFt:1350,scrapeUrl:"https://skiragged.com",conditionsUrl:"https://skiragged.com/mountain-report"},{id:"saddleback",name:"Saddleback",state:"ME",lat:44.9531,lon:-70.5272,scrapeUrl:"https://www.saddlebackmaine.com/conditions/"},{id:"squaw-mountain",name:"Squaw Mountain",state:"ME",lat:44.0822,lon:-70.7567,scrapeUrl:"https://www.squawmt.com/conditions/"},{id:"jiminy-peak",name:"Jiminy Peak",state:"MA",lat:42.5556,lon:-73.2922,scrapeUrl:"https://www.jiminypeak.com/mountain/conditions"},{id:"wachusett",name:"Wachusett",state:"MA",lat:42.5031,lon:-71.8867,scrapeUrl:"https://www.wachusett.com/The-Mountain/Conditions.aspx"},{id:"whiteface",name:"Whiteface",state:"NY",lat:44.3656,lon:-73.9022,scrapeUrl:"https://whiteface.com/conditions"},{id:"gore-mountain",name:"Gore Mountain",state:"NY",lat:43.6747,lon:-74.0061,scrapeUrl:"https://goremountain.com/conditions/"},{id:"hunter-mountain",name:"Hunter Mountain",state:"NY",lat:42.2022,lon:-74.2331,scrapeUrl:"https://www.huntermtn.com/the-mountain/mountain-conditions"},{id:"windham-mountain",name:"Windham Mountain",state:"NY",lat:42.2917,lon:-74.2581,scrapeUrl:"https://www.windhammountain.com/the-mountain/mountain-conditions"},{id:"belleayre",name:"Belleayre",state:"NY",lat:42.1356,lon:-74.5061,scrapeUrl:"https://www.belleayre.com/conditions/"},{id:"jack-frost-big-boulder",name:"Jack Frost Big Boulder",state:"PA",lat:41.1081,lon:-75.6581,scrapeUrl:"https://www.jfbb.com/conditions/"},{id:"elk-mountain",name:"Elk Mountain",state:"PA",lat:41.7131,lon:-75.5781,scrapeUrl:"https://www.elkskier.com/conditions/"},{id:"blue-mountain",name:"Blue Mountain",state:"PA",lat:40.8117,lon:-75.5217,scrapeUrl:"https://www.skibluemt.com/mountain-report/"},{id:"seven-springs",name:"Seven Springs",state:"PA",lat:40.0231,lon:-79.2981,scrapeUrl:"https://www.7springs.com/conditions/"},{id:"mount-southington",name:"Mount Southington",state:"CT",lat:41.5992,lon:-72.9272,scrapeUrl:"https://mountsouthington.com/conditions/"},{id:"powder-ridge",name:"Powder Ridge",state:"CT",lat:41.4992,lon:-72.8272,scrapeUrl:"https://www.powderridgepark.com/conditions/"},{id:"mountain-creek",name:"Mountain Creek",state:"NJ",lat:41.1822,lon:-74.5081,scrapeUrl:"https://www.mountaincreek.com/mountain/conditions/"},{id:"campgaw-mountain",name:"Campgaw Mountain",state:"NJ",lat:41.0481,lon:-74.2081,scrapeUrl:"https://www.campgaw.com/conditions/"},{id:"black-mountain",name:"Black Mountain",state:"NH",lat:44.1667,lon:-71.1667,scrapeUrl:"https://www.blackmt.com/conditions/"}];for(let e of b)void 0!==e.baseElevationFt&&void 0!==e.summitElevationFt&&(void 0===e.elevationFt||null===e.elevationFt)&&(e.elevationFt=Math.round((e.baseElevationFt+e.summitElevationFt)/2*10)/10),void 0===e.elevationFt&&delete e.elevationFt;async function y(e,t){let n=`https://api.weather.gov/points/${e},${t}`,a=await fetch(n,{headers:{"User-Agent":"ski-conditions-aggregator"}});if(!a.ok)throw Error("Failed to get NWS gridpoint");let o=await a.json();return{office:o.properties.gridId,gridX:o.properties.gridX,gridY:o.properties.gridY}}async function k(e,t){let n=await y(e,t),a=`https://api.weather.gov/gridpoints/${n.office}/${n.gridX},${n.gridY}/forecast`,o=await fetch(a,{headers:{"User-Agent":"ski-conditions-aggregator"}});if(!o.ok)throw Error("Failed to get NWS forecast");let i=(await o.json()).properties.periods[0];return{temperature:i.temperature,windSpeed:i.windSpeed?parseInt(i.windSpeed):null,windDirection:i.windDirection||null,textDescription:i.shortForecast,icon:i.icon,timestamp:i.startTime,raw:i}}async function N(e,t){try{var n,a,o,i;let r,s,l,u,p=`https://api.weather.gov/points/${e},${t}`,c=await fetch(p,{headers:{"User-Agent":"ski-conditions-aggregator"}});if(!c.ok)return{stationId:null,distanceKm:null};let d=(await c.json()).properties.observationStations;if(!d)return{stationId:null,distanceKm:null};let m=await fetch(d,{headers:{"User-Agent":"ski-conditions-aggregator"}});if(!m.ok)return{stationId:null,distanceKm:null};let w=await m.json(),h=w.features||w;if(!h||0===h.length)return{stationId:null,distanceKm:null};let f=h[0],g=f&&f.geometry&&f.geometry.coordinates?f.geometry.coordinates:null;if(!g)return{stationId:f.properties?.stationIdentifier??null,distanceKm:null};let[v,b]=g,y=(n=e,a=t,o=b,i=v,s=(r=e=>e*Math.PI/180)(o-n),l=r(i-a),u=Math.sin(s/2)*Math.sin(s/2)+Math.cos(r(n))*Math.cos(r(o))*Math.sin(l/2)*Math.sin(l/2),2*Math.atan2(Math.sqrt(u),Math.sqrt(1-u))*6371);return{stationId:f.properties?.stationIdentifier??null,distanceKm:y}}catch(e){return{stationId:null,distanceKm:null}}}async function S(e,t,n){try{let a=`https://api.weather.gov/stations/${e}/observations?start=${encodeURIComponent(t)}&end=${encodeURIComponent(n)}&limit=500`,o=await fetch(a,{headers:{"User-Agent":"ski-conditions-aggregator"}});if(!o.ok)return[];return(await o.json()).features||[]}catch(e){return[]}}async function M(e,t,n=7){try{let{stationId:a,distanceKm:o}=await N(e,t);if(!a)return{observations:[],stationId:null,stationDistanceKm:null};let i=new Date,r=new Date(i.getTime()-24*n*36e5).toISOString(),s=i.toISOString();return{observations:await S(a,r,s),stationId:a,stationDistanceKm:o}}catch(e){return{observations:[],stationId:null,stationDistanceKm:null}}}let U=function(e,t){let n,a={recentSnowfall:0,snowDepth:0,baseTemp:NaN,windSpeed:0,visibility:"Unknown",powderScore:50,factors:[]};if(!e)return a;let o=null;if("number"==typeof e.temperature){let t=e?.raw?.temperatureUnit||e?.raw?.temperature?.unitCode||null;o=t&&String(t).toUpperCase().startsWith("F")?(e.temperature-32)*5/9:e.temperature}else e?.raw?.temperature?.value!=null&&(o=e.raw.temperature.value);if(null==o||Number.isNaN(o)||(a.baseTemp=+(9*o/5+32).toFixed(1)),"number"==typeof e.windSpeed)a.windSpeed=e.windSpeed;else if(e?.raw?.windSpeed?.value!=null){let t=e.raw.windSpeed.value;Number.isNaN(t)||(a.windSpeed=+(2.23694*t).toFixed(2))}a.visibility=e?.textDescription??a.visibility;let i=null;if(e?.raw?.precipitationLastHour?.value!=null){let t=e.raw.precipitationLastHour.value;Number.isNaN(t)||(i=+(t/25.4))}if(null==i&&e?.raw?.precipitation?.value!=null){let t=e.raw.precipitation.value,n=e.raw.precipitation?.unitCode||"";"number"==typeof t&&(i=n.toLowerCase().includes("mm")?+(t/25.4):+t)}let r=e?.raw?.probabilityOfPrecipitation?.value??e?.raw?.probabilityOfPrecipitation??null,s=(e?.textDescription||"").toLowerCase(),l=s.includes("snow")||s.includes("flurr"),u=s.includes("sleet")||s.includes("mixed"),p=0;if(null!=i)p=Number.isNaN(a.baseTemp)?l?.9:u?.6:.2:a.baseTemp<=28?1:a.baseTemp<=32?.9:a.baseTemp<=36?.6:.05;else{let e="number"!=typeof r||Number.isNaN(r)?0:r/100;if(e>0){let t=Math.min(.5,.5*e);p=Number.isNaN(a.baseTemp)?l?.9:u?.6:.2:a.baseTemp<=28?1:a.baseTemp<=32?.95:a.baseTemp<=36?.6:.1,i=t}else p=.8*!!l}let c=10;if(!Number.isNaN(a.baseTemp)){let e=(a.baseTemp-32)*5/9;c=e<=-10?18:e<=-2?14:e<=0?12:e<=3?10:8}let d=0;null!=i?(d=i*c*p,i>0&&i<.5&&(d*=.6)):d=(i||0)*c*p,a.recentSnowfall=Math.max(0,Math.round(2*d)/2);let m=e?.raw?.snowDepth?.value??e?.raw?.snowDepth??e?.raw?.snowFallLast24Hours?.value??null;if(null==m||Number.isNaN(m)){let e=t&&"number"==typeof t.previousDepth?t.previousDepth:0;a.snowDepth=+Math.max(e,e+a.recentSnowfall).toFixed(1)}else"number"==typeof m&&(m>30?a.snowDepth=+(m/25.4).toFixed(1):a.snowDepth=+m.toFixed(1));n=50+Math.round((a.recentSnowfall-2)*4),!Number.isNaN(a.baseTemp)&&a.baseTemp<=20&&(n+=10),a.windSpeed>25&&(n-=20),a.recentSnowfall>=8&&(n+=8),a.powderScore=Math.min(100,Math.max(0,n)),a.recentSnowfall>=6?a.factors.push("recent-heavy"):a.recentSnowfall>=2&&a.factors.push("recent-light"),!Number.isNaN(a.baseTemp)&&a.baseTemp>=36&&a.factors.push("warm"),a.windSpeed>25&&a.factors.push("windy");let w=0,h=0,f=0;if(t&&Array.isArray(t.weeklyObservations)&&t.weeklyObservations.length>0){let e=0;for(let n of t.weeklyObservations){let a=n&&"number"==typeof n.precipMm?n.precipMm:0,o=n&&"number"==typeof n.tempC?n.tempC:t.avgTemp7d??null,i=a/25.4,r=0;r=null!=o?o<=-10?1:o<=0?.95:o<=3?.9:.1:l?.8:.2;let s=c;null!=o&&(s=o<=-10?18:o<=-2?14:o<=0?12:o<=3?10:8);let u=i*s*r;i>0&&i<.5&&(u*=.6),e+=u,f+=i*(1-r),h+=u}w=Math.round(2*e)/2}else if(t&&"number"==typeof t.weeklyPrecipMm&&null!==t.weeklyPrecipMm){let e=t.weeklyPrecipMm/25.4,n=Number.isNaN(a.baseTemp)?p||.5:a.baseTemp<=32?.9:.1;h=Math.round(e*c*n*2)/2,f=Math.round(e*(1-n)*100)/100,w=h}else w=t&&"number"==typeof t.previousWeekSnowfall&&null!==t.previousWeekSnowfall?t.previousWeekSnowfall:Math.round((a.recentSnowfall+Math.max(0,+a.recentSnowfall))*2)/2;let g=t&&"number"==typeof t.stationDistanceKm?t.stationDistanceKm:null;null!=g&&g>50&&(w=Math.max(0,w*(1-(g>=150?.4:.1+Math.min(.3,(g-50)/100*.3)))),a.factors.push("station-distance"));if(a.weeklySnowfall=Math.max(0,Math.round(2*w)/2),a.weeklySnowIn=Math.max(0,Math.round(2*h)/2),a.weeklyRainIn=Math.max(0,Math.round(100*f)/100),t&&"number"==typeof t.resortReportedWeekly&&null!==t.resortReportedWeekly){let e=Math.max(0,t.resortReportedWeekly),n="number"==typeof a.weeklySnowfall?a.weeklySnowfall:0,o=.7;"number"==typeof t.resortWeight&&t.resortWeight>=0&&t.resortWeight<=1&&(o=t.resortWeight);let i=Math.round((e*o+n*(1-o))*2)/2;a.factors.push("resort-reported"),a.factors.push(`resort-weight:${o}`),a.weeklySnowfall=i}let v=a.snowDepth||0,b=1,y=t&&"number"==typeof t.avgTemp7d?t.avgTemp7d:null;null!=y&&(y>0?b*=.6:y>-2?b*=.85:b*=1);let k=t&&"number"==typeof t.avgWind7d?t.avgWind7d:null;if(null!=k){let e=.621371*k;e>40?b*=.7:e>25&&(b*=.85)}let N=t&&"number"==typeof t.avgSunHours7d?t.avgSunHours7d:null;null!=N&&(N>4?b*=.85:N>2&&(b*=.95));let S=t&&"number"==typeof t.elevationFt?t.elevationFt:null;return null!=S&&(b*=1+Math.max(0,Math.min(.3,(S-1e3)/1e4))),a.recentSnowfall<=1&&(b*=.95),a.expectedOnGround=Math.round(10*Math.max(0,v*b))/10,a};async function R(e){let{searchParams:t}=new URL(e.url),n=t.get("resortId");if(!n)return v.NextResponse.json({error:"resortId required"},{status:400});let a=b.find(e=>e.id===n);if(!a)return v.NextResponse.json({error:"Resort not found"},{status:404});try{let t=null;try{t=await k(a.lat,a.lon)}catch(e){t=null}let o={};try{let t=new URL(e.url),n=t.searchParams.get("resortReportedWeekly"),a=t.searchParams.get("resortWeight");if(null!=n){let e=parseFloat(n);Number.isNaN(e)||(o.resortReportedWeekly=e)}if(null!=a){let e=parseFloat(a);Number.isNaN(e)||(o.resortWeight=e)}}catch(e){}try{let e=await M(a.lat,a.lon,7);if(e&&Array.isArray(e.observations)&&e.observations.length>0){let t=[],n=0;for(let a of e.observations){let e=a.properties||a,o=e.precipitationLastHour&&"number"==typeof e.precipitationLastHour.value?e.precipitationLastHour.value:e.precipitation&&"number"==typeof e.precipitation.value?e.precipitation.value:null,i=e.temperature&&"number"==typeof e.temperature.value?e.temperature.value:"number"==typeof e.temperature?e.temperature:null,r=e.windSpeed&&"number"==typeof e.windSpeed.value?3.6*e.windSpeed.value:null;t.push({precipMm:o,tempC:i,windKph:r,timestamp:e.timestamp||e.validTime||null}),"number"==typeof o&&(n+=o)}o.weeklyObservations=t,o.weeklyPrecipMm=n,o.avgTemp7d=t.reduce((e,t)=>e+(t.tempC??0),0)/Math.max(1,t.length),o.avgWind7d=t.reduce((e,t)=>e+(t.windKph??0),0)/Math.max(1,t.length),o.elevationFt=a.elevationFt??null,o.stationDistanceKm=e.stationDistanceKm}}catch(e){}let i=U(t,o),r={resortId:n,timestamp:new Date,snowDepth:i.snowDepth,recentSnowfall:i.recentSnowfall,weeklySnowfall:i.weeklySnowfall??0,expectedOnGround:i.expectedOnGround??i.snowDepth,baseTemp:i.baseTemp??0,windSpeed:i.windSpeed??0,visibility:i.visibility,trailStatus:{open:0,total:0,groomed:0},rawData:{nws:t,model:i}};return v.NextResponse.json(r)}catch(e){return v.NextResponse.json({error:e.message,type:"scrape-failed"},{status:502})}}e.s(["GET",()=>R],54625);var E=e.i(54625);let T=new t.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/scrape/route",pathname:"/api/scrape",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/app/api/scrape/route.ts",nextConfigOutput:"",userland:E}),{workAsyncStorage:x,workUnitAsyncStorage:C,serverHooks:A}=T;function F(){return(0,a.patchFetch)({workAsyncStorage:x,workUnitAsyncStorage:C})}async function D(e,t,a){T.isDev&&(0,o.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let v="/api/scrape/route";v=v.replace(/\/index$/,"")||"/";let b=await T.prepare(e,t,{srcPage:v,multiZoneDraftMode:!1});if(!b)return t.statusCode=400,t.end("Bad Request"),null==a.waitUntil||a.waitUntil.call(a,Promise.resolve()),null;let{buildId:y,params:k,nextConfig:N,parsedUrl:S,isDraftMode:M,prerenderManifest:U,routerServerContext:R,isOnDemandRevalidate:E,revalidateOnlyGenerated:x,resolvedPathname:C,clientReferenceManifest:A,serverActionsManifest:F}=b,D=(0,s.normalizeAppPath)(v),P=!!(U.dynamicRoutes[D]||U.routes[C]),H=async()=>((null==R?void 0:R.render404)?await R.render404(e,t,S,!1):t.end("This page could not be found"),null);if(P&&!M){let e=!!U.routes[C],t=U.dynamicRoutes[D];if(t&&!1===t.fallback&&!e){if(N.experimental.adapterPath)return await H();throw new f.NoFallbackError}}let I=null;!P||T.isDev||M||(I="/index"===(I=C)?"/":I);let O=!0===T.isDev||!P,W=P&&!O;F&&A&&(0,r.setManifestsSingleton)({page:v,clientReferenceManifest:A,serverActionsManifest:F});let K=e.method||"GET",j=(0,i.getTracer)(),q=j.getActiveScopeSpan(),$={params:k,prerenderManifest:U,renderOpts:{experimental:{authInterrupts:!!N.experimental.authInterrupts},cacheComponents:!!N.cacheComponents,supportsDynamicResponse:O,incrementalCache:(0,o.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:N.cacheLife,waitUntil:a.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,n,a,o)=>T.onRequestError(e,t,a,o,R)},sharedContext:{buildId:y}},_=new l.NodeNextRequest(e),L=new l.NodeNextResponse(t),V=u.NextRequestAdapter.fromNodeNextRequest(_,(0,u.signalFromNodeResponse)(t));try{let r=async e=>T.handle(V,$).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let n=j.getRootSpanAttributes();if(!n)return;if(n.get("next.span_type")!==p.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${n.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let a=n.get("next.route");if(a){let t=`${K} ${a}`;e.setAttributes({"next.route":a,"http.route":a,"next.span_name":t}),e.updateName(t)}else e.updateName(`${K} ${v}`)}),s=!!(0,o.getRequestMeta)(e,"minimalMode"),l=async o=>{var i,l;let u=async({previousCacheEntry:n})=>{try{if(!s&&E&&x&&!n)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let i=await r(o);e.fetchMetrics=$.renderOpts.fetchMetrics;let l=$.renderOpts.pendingWaitUntil;l&&a.waitUntil&&(a.waitUntil(l),l=void 0);let u=$.renderOpts.collectedTags;if(!P)return await (0,d.sendResponse)(_,L,i,$.renderOpts.pendingWaitUntil),null;{let e=await i.blob(),t=(0,m.toNodeOutgoingHttpHeaders)(i.headers);u&&(t[h.NEXT_CACHE_TAGS_HEADER]=u),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let n=void 0!==$.renderOpts.collectedRevalidate&&!($.renderOpts.collectedRevalidate>=h.INFINITE_CACHE)&&$.renderOpts.collectedRevalidate,a=void 0===$.renderOpts.collectedExpire||$.renderOpts.collectedExpire>=h.INFINITE_CACHE?void 0:$.renderOpts.collectedExpire;return{value:{kind:g.CachedRouteKind.APP_ROUTE,status:i.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:n,expire:a}}}}catch(t){throw(null==n?void 0:n.isStale)&&await T.onRequestError(e,t,{routerKind:"App Router",routePath:v,routeType:"route",revalidateReason:(0,c.getRevalidateReason)({isStaticGeneration:W,isOnDemandRevalidate:E})},!1,R),t}},p=await T.handleResponse({req:e,nextConfig:N,cacheKey:I,routeKind:n.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:U,isRoutePPREnabled:!1,isOnDemandRevalidate:E,revalidateOnlyGenerated:x,responseGenerator:u,waitUntil:a.waitUntil,isMinimalMode:s});if(!P)return null;if((null==p||null==(i=p.value)?void 0:i.kind)!==g.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==p||null==(l=p.value)?void 0:l.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});s||t.setHeader("x-nextjs-cache",E?"REVALIDATED":p.isMiss?"MISS":p.isStale?"STALE":"HIT"),M&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let f=(0,m.fromNodeOutgoingHttpHeaders)(p.value.headers);return s&&P||f.delete(h.NEXT_CACHE_TAGS_HEADER),!p.cacheControl||t.getHeader("Cache-Control")||f.get("Cache-Control")||f.set("Cache-Control",(0,w.getCacheControlHeader)(p.cacheControl)),await (0,d.sendResponse)(_,L,new Response(p.value.body,{headers:f,status:p.value.status||200})),null};q?await l(q):await j.withPropagatedContext(e.headers,()=>j.trace(p.BaseServerSpan.handleRequest,{spanName:`${K} ${v}`,kind:i.SpanKind.SERVER,attributes:{"http.method":K,"http.target":e.url}},l))}catch(t){if(t instanceof f.NoFallbackError||await T.onRequestError(e,t,{routerKind:"App Router",routePath:D,routeType:"route",revalidateReason:(0,c.getRevalidateReason)({isStaticGeneration:W,isOnDemandRevalidate:E})},!1,R),P)throw t;return await (0,d.sendResponse)(_,L,new Response(null,{status:500})),null}}e.s(["handler",()=>D,"patchFetch",()=>F,"routeModule",()=>T,"serverHooks",()=>A,"workAsyncStorage",()=>x,"workUnitAsyncStorage",()=>C],93366)}];

//# sourceMappingURL=node_modules_next_dist_esm_build_templates_app-route_ec576fa7.js.map